<!doctype html><html class="position-relative" itemscope itemtype="http://schema.org/WebPage" lang="zh-cn"
  
   data-palette="blue"
  >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Docker-配置文档 - 编程日记</title><link rel="apple-touch-icon" href="/images/icons/icon-180x180.png" sizes="180x180">
<link rel="icon" href="/images/icons/icon-32x32.png" sizes="32x32" type="image/png">
<link rel="icon" href="/images/icons/icon-16x16.png" sizes="16x16" type="image/png">
<link rel="icon" href="/images/icons/favicon.ico">
<link rel="manifest" href="/manifest.json">
<script type="text/javascript"
        async
        src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[\[','\]\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});

MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<style>
code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style>

<meta name="keywords" content="" />
<meta name="description" content="哔哩哔哩【编程不良人】Docker&amp;Docker-Compose 实战!_哔哩哔哩_bilibili的教程的文档总结" /><meta name="robots" content="index, follow" /><meta itemprop="name" content="Docker-配置文档">
<meta itemprop="description" content="哔哩哔哩【编程不良人】Docker&amp;Docker-Compose 实战!_哔哩哔哩_bilibili的教程的文档总结"><meta itemprop="datePublished" content="2022-01-06T21:34:27+00:00" />
<meta itemprop="dateModified" content="2022-01-06T21:34:27+00:00" />
<meta itemprop="wordCount" content="13517">
<meta itemprop="keywords" content="教程,Docker," /><meta property="og:title" content="Docker-配置文档" />
<meta property="og:description" content="哔哩哔哩【编程不良人】Docker&amp;Docker-Compose 实战!_哔哩哔哩_bilibili的教程的文档总结" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/ddeb9b11/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-06T21:34:27+00:00" />
<meta property="article:modified_time" content="2022-01-06T21:34:27+00:00" /><meta property="og:site_name" content="编程日记" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Docker-配置文档"/>
<meta name="twitter:description" content="哔哩哔哩【编程不良人】Docker&amp;Docker-Compose 实战!_哔哩哔哩_bilibili的教程的文档总结"/>
<meta property="og:image" content="/images/spider-man.jpg"/>
  <meta name="twitter:image" content="/images/spider-man.jpg"/><link rel="stylesheet" href="/assets/main/bundle.min.d09b7f7f687cbba5a0470808fba7973668726b909146fb392a44aa897b257a10.css" integrity="sha256-0Jt/f2h8u6WgRwgI+6eXNmhya5CRRvs5KkSqiXslehA=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/viewer/bundle.min.f05183267bb952fbc8c63a7178364de2951614ab71d544ec1068ad36c7447ccc.css" integrity="sha256-8FGDJnu5UvvIxjpxeDZN4pUWFKtx1UTsEGitNsdEfMw=" crossorigin="anonymous"></head>
  <body><script>const items=['mode','palette'];items.forEach(function(e){const t=localStorage.getItem('hbs-'+e);t&&document.body.parentElement.setAttribute('data-'+e,t)})</script><header><nav class="navbar top-app-bar top-app-bar-expand-lg fixed-top">
  <div class="container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <i class="fas fa-bars"></i>
    </button><a class="navbar-brand flex-grow-1 flex-lg-grow-0 text-center text-lg-start mx-auto me-lg-3" href="/"><picture><img class="logo" alt="Logo" src="/images/spider-man.jpg" loading="lazy"
     width="556" height="559"
     />
</picture>
编程日记
    </a>
    <div class="offcanvas offcanvas-bottom surface" tabindex="-1" id="offcanvasSocialShare" aria-labelledby="offcanvasSocialShare">
  <div class="offcanvas-header">
    <h3 class="offcanvas-title">Share</h3>
    <button type="button" class="btn btn-sm btn-outline-primary" data-bs-dismiss="offcanvas" aria-label="Close">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div class="offcanvas-body">
    <a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Twitter Share Button"
      target="_blank" href="https://twitter.com/intent/tweet?title=Docker-%e9%85%8d%e7%bd%ae%e6%96%87%e6%a1%a3&url=%2fposts%2fddeb9b11%2f">
      <i class="fab fa-fw fa-twitter"></i> Twitter
    </a>
    <a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Facebook Share Button"
      target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=%2fposts%2fddeb9b11%2f">
      <i class="fab fa-fw fa-facebook-f"></i> Facebook
    </a>
  </div>
</div>
    <button class="navbar-settings" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSettings"
  aria-controls="offcanvasSettings" aria-label="Toggle settings">
  <i class="fas fa-ellipsis-v"></i>
</button>

<div class="offcanvas offcanvas-end surface h-100" tabindex="-1" id="offcanvasSettings" aria-labelledby="offcanvasSettings">
  <div class="offcanvas-header">
    <h3 class="offcanvas-title">设置</h3>
    <button type="button" class="btn btn-sm btn-outline-primary" data-bs-dismiss="offcanvas" aria-label="Close">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div class="offcanvas-body d-flex flex-column">

<div class="setting">
  <form class="row">
    <div class="col-auto">
      <label><i class="fas fa-fw fa-adjust"></i> 模式</label>
    </div>
    <div class="col-auto ms-auto">
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" id="modeSwitcher">
      </div>
    </div>
  </form>
</div>

<div class="setting">
  <form class="font-size-switcher-form row">
    <div class="col-auto">
      <label for="fontSize" class="form-label"><i class="fas fa-fw fa-font"></i> 字体大小</label>
    </div>
    <div class="col-auto ms-auto">
      <input type="range" class="form-range" min="-2" max="2" id="fontSize">
    </div>
  </form>
</div>


<div class="setting palettes">
  <form class="row">
    <div class="col-auto">
      <label><i class="fas fa-fw fa-palette"></i> 配色</label>
    </div>
    <div class="col-auto ms-auto">
      <a id="btnPalette" class="btn btn-sm btn-outline-primary" role="button" aria-label="palettePicker">
        <i class="fas fa-eye-dropper"></i>
      </a>
    </div>
  </form>
  <div class="mt-2 d-flex justify-content-between visually-hidden" id="palettePicker"><button type="button" id="palette-blue" aria-label="蓝色"
        class="btn btn-sm w-100 palette" data-palette="blue">
      </button><button type="button" id="palette-blue-gray" aria-label="蓝灰色"
        class="btn btn-sm w-100 palette" data-palette="blue-gray">
      </button><button type="button" id="palette-brown" aria-label="棕色"
        class="btn btn-sm w-100 palette" data-palette="brown">
      </button><button type="button" id="palette-cyan" aria-label="青色"
        class="btn btn-sm w-100 palette" data-palette="cyan">
      </button><button type="button" id="palette-green" aria-label="绿色"
        class="btn btn-sm w-100 palette" data-palette="green">
      </button><button type="button" id="palette-indigo" aria-label="靛青色"
        class="btn btn-sm w-100 palette" data-palette="indigo">
      </button><button type="button" id="palette-orange" aria-label="橙色"
        class="btn btn-sm w-100 palette" data-palette="orange">
      </button><button type="button" id="palette-pink" aria-label="粉色"
        class="btn btn-sm w-100 palette" data-palette="pink">
      </button><button type="button" id="palette-purple" aria-label="紫色"
        class="btn btn-sm w-100 palette" data-palette="purple">
      </button><button type="button" id="palette-red" aria-label="红色"
        class="btn btn-sm w-100 palette" data-palette="red">
      </button><button type="button" id="palette-teal" aria-label="蓝绿色"
        class="btn btn-sm w-100 palette" data-palette="teal">
      </button><button type="button" id="palette-yellow" aria-label="黄色"
        class="btn btn-sm w-100 palette" data-palette="yellow">
      </button></div>
</div>
<div class="setting actions d-flex justify-content-around mt-auto overflow-auto">
  <a role="button" class="action action-go-back" href="javascript: window.history.back();">
    <span class="action-icon"><i class="fas fa-2x fa-chevron-circle-down" data-fa-transform="rotate-90"></i></span> 返回
  </a>
  <a role="button" class="action action-reload-page">
    <span class="action-icon"><i class="fas fa-2x fa-redo-alt"></i></span> 刷新
  </a>
  <a role="button" class="action action-copy-url">
    <span class="action-icon"><i class="fas fa-2x fa-link"></i></span> 复制链接
  </a><a class="action action-social-share" role="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSocialShare"
    aria-controls="offcanvasSocialShare" aria-label="Toggle social share">
    <span class="action-icon"><i class="fas fa-2x fa-share-alt"></i></span> 分享
  </a></div>

</div>
</div>

    <div class="collapse navbar-collapse" tabindex="-1" id="navbarSupportedContent" aria-labelledby="navbarSupportedContent">
      <form class="search-bar my-1" action="/search">
  <div class="input-group input-group-sm">
    <span class="btn btn-search disabled position-absolute left-0"><i class="fas fa-fw fa-search"></i></span>
    <input class="form-control rounded-pill" name="q" type="search" aria-label="Search">
  </div>
</form>
      <ul class="navbar-nav ms-auto"><li class="nav-item">
          <a class="nav-link" href="/series/">
            <i class="fas fa-fw fa-columns"></i>专栏
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="/archives/">
            <i class="fas fa-fw fa-file-archive"></i>归档
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="/categories/">
            <i class="fas fa-fw fa-folder"></i>分类
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="/tags/">
            <i class="fas fa-fw fa-tags"></i>标签
          </a>
        </li><li class="nav-item dropdown">
          <a class="nav-link" id="navbarDropdownFriends" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="fas fa-fw fa-chevron-circle-down"></i>友情链接
          </a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdownFriends"><li>
              <a class="dropdown-item"
                href="https://xieash.work/" target="_blank" rel="noopener noreferrer">
                xieash
              </a>
            </li><li>
              <a class="dropdown-item"
                href="https://sunnysab.cn/" target="_blank" rel="noopener noreferrer">
                sunnysab
              </a>
            </li><li>
              <a class="dropdown-item"
                href="https://wanfengcxz.cn/" target="_blank" rel="noopener noreferrer">
                wanfengcxz
              </a>
            </li><li>
              <a class="dropdown-item"
                href="https://zhangzqs.cn/" target="_blank" rel="noopener noreferrer">
                zhangzqs
              </a>
            </li></ul>
        </li><li class="nav-item">
          <a class="nav-link" href="/data">
            资料
          </a>
        </li></ul>
    </div>
  </div>
</nav>
</header>
<main class="container">
      <div class="row content">
<div class="col-lg-8">
  <div class="container"><nav class="row card component" aria-label="breadcrumb">
  <div class="card-body">
    <ol class="breadcrumb "><li class="breadcrumb-item"><a href="/">主页</a></li><li class="breadcrumb-item"><a href="/posts/">Posts</a></li><li class="breadcrumb-item active">Docker-配置文档</li></ol>
  </div>
</nav><div class="post-panel-wrapper position-sticky">
  <div class="d-flex flex-column component rounded post-panel position-absolute">
    
    <a class="action action-panel-toggler" role="button" title="Panel toggler">
      <i class="fas fa-fw fa-chevron-circle-down"></i>
    </a>
    <a id="sidebarToggler" class="action d-none d-lg-block" role="button" title="Sidebar toggler">
  <i class="fas fa-fw fa-expand-alt" data-fa-transform="rotate-45"></i>
</a>

    

    
    <a class="action" href="#post-copyright" role="button" aria-label="Copyright" title="Copyright">
  <i class="fas fa-fw fa-copyright"></i>
</a>
    
    <a class="action" href="#postTOC" aria-controls="Table of contents" role="button" title="Table of contents">
  <i class="fas fa-fw fa-list-alt"></i>
</a>
    
  </div>
</div>
<article class="row card component mb-4 post">
  <div class="card-header ">
    <h1 class="card-title post-title">Docker-配置文档
</h1>
  </div>
  <div class="card-body"><div class="post-meta">
  <span class="post-date" title="创建于 2022-01-07 05:34:27 &#43;0800 CST。">
    2022-01-06
  </span><span class="post-reading-time">
    27 分钟阅读
  </span><span class="post-taxonomies"><a href="/tags/%E6%95%99%E7%A8%8B/" class="badge post-taxonomy">教程</a><a href="/tags/docker/" class="badge post-taxonomy">Docker</a></span>
</div>
<div class="post-content mb-3"><p>哔哩哔哩<a href="https://www.bilibili.com/video/BV1wQ4y1Y7SE?spm_id_from=333.999.0.0" target="_blank" rel="noopener noreferrer">【编程不良人】Docker&amp;Docker-Compose 实战!_哔哩哔哩_bilibili</a>的教程的文档总结</p>
<ul>
<li>
<p>官方文档地址:https://www.docker.com/get-started</p>
</li>
<li>
<p>中文参考手册:https://docker_practice.gitee.io/zh-cn/</p>
</li>
</ul>
<hr>
<h2 id="1什么是-docker">1.什么是 Docker<a class="anchor ms-1" href="#1什么是-docker"><i class="fas fa-link"></i></a></h2>
<h3 id="11-官方定义">1.1 官方定义<a class="anchor ms-1" href="#11-官方定义"><i class="fas fa-link"></i></a></h3>
<ul>
<li>最新官网首页</li>
</ul>
<p><picture><img class="img-fluid" alt="image-20201220213306128" src="/posts/ddeb9b11/index/image-20201220213306128.png" loading="lazy"
    
     />
</picture>

</p>
<p><picture><img class="img-fluid" alt="image-20201220214210994" src="/posts/ddeb9b11/index/image-20201220214210994.png" loading="lazy"
    
     />
</picture>

</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl"><span class="gh"># 1.官方介绍
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="gh"></span><span class="k">-</span> We have a complete container solution for you - no matter who you are and where you are on your containerization journey.
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="k">-</span> 翻译: 我们为你提供了一个完整的容器解决方案,不管你是谁,不管你在哪,你都可以开始容器的的旅程。
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="k">-</span> 官方定义: docker是一个容器技术。
</span></span></code></pre></div><h3 id="12-docker的起源">1.2 Docker的起源<a class="anchor ms-1" href="#12-docker的起源"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl">Docker 最初是 dotCloud 公司创始人 Solomon Hykes 在法国期间发起的一个公司内部项目，它是基于 dotCloud 公司多年云服务技术的一次革新，并于 2013 年 3 月以 Apache 2.0 授权协议开源，主要项目代码在 GitHub 上进行维护。Docker 项目后来还加入了 Linux 基金会，并成立推动 开放容器联盟（OCI）。
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">Docker 自开源后受到广泛的关注和讨论，至今其 GitHub 项目 已经超过 5 万 7 千个星标和一万多个 fork。甚至由于 Docker 项目的火爆，在 2013 年底，dotCloud 公司决定改名为 Docker。Docker 最初是在 Ubuntu 12.04 上开发实现的；Red Hat 则从 RHEL 6.5 开始对 Docker 进行支持；Google 也在其 PaaS 产品中广泛应用 Docker。
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl">Docker 使用 Google 公司推出的 Go 语言 进行开发实现，基于 Linux 内核的 cgroup，namespace，以及 OverlayFS 类的 Union FS 等技术，对进程进行封装隔离，属于操作系统层面的虚拟化技术。由于隔离的进程独立于宿主和其它的隔离的进程，因此也称其为容器。
</span></span></code></pre></div><h2 id="2为什么是docker">2.为什么是Docker<a class="anchor ms-1" href="#2为什么是docker"><i class="fas fa-link"></i></a></h2>
<ul>
<li>
<p><code>在开发的时候，在本机测试环境可以跑，生产环境跑不起来</code></p>
<p>这里我们拿java Web应用程序举例，我们一个java Web应用程序涉及很多东西，比如jdk、tomcat、mysql等软件环境。当这些其中某一项版本不一致的时候，可能就会导致应用程序跑不起来这种情况。Docker则将程序以及使用软件环境直接打包在一起，无论在那个机器上保证了环境一致。</p>
<p><strong>优势1:  一致的运行环境,更轻松的迁移</strong></p>
</li>
<li>
<p><code>服务器自己的程序挂了，结果发现是别人程序出了问题把内存吃完了，自己程序因为内存不够就挂了</code></p>
<p>这种也是一种比较常见的情况，如果你的程序重要性不是特别高的话，公司基本上不可能让你的程序独享一台服务器的，这时候你的服务器就会跟公司其他人的程序共享一台服务器，所以不可避免地就会受到其他程序的干扰，导致自己的程序出现问题。Docker就很好解决了环境隔离的问题，别人程序不会影响到自己的程序。</p>
<p><strong>优势2：对进程进行封装隔离,容器与容器之间互不影响,更高效的利用系统资源</strong></p>
</li>
<li>
<p><code>公司要弄一个活动，可能会有大量的流量进来，公司需要再多部署几十台服务器</code></p>
<p>在没有Docker的情况下，要在几天内部署几十台服务器，这对运维来说是一件非常折磨人的事，而且每台服务器的环境还不一定一样，就会出现各种问题，最后部署地头皮发麻。用Docker的话，我只需要将程序打包到镜像，你要多少台服务，我就给力跑多少容器，极大地提高了部署效率。</p>
<p><strong>优势3: 通过镜像复制N多个环境一致容器</strong></p>
</li>
</ul>
<hr>
<h2 id="3docker和虚拟机区别">3.Docker和虚拟机区别<a class="anchor ms-1" href="#3docker和虚拟机区别"><i class="fas fa-link"></i></a></h2>
<blockquote>
<p>关于Docker与虚拟机的区别，我在网上找到的一张图，非常直观形象地展示出来，话不多说，直接上图。</p>
</blockquote>
<p><picture><img class="img-fluid" alt="image-20201220222456675" src="/posts/ddeb9b11/index/image-20201220222456675.png" loading="lazy"
    
     />
</picture>

</p>
<p><code>比较上面两张图，我们发现虚拟机是携带操作系统，本身很小的应用程序却因为携带了操作系统而变得非常大，很笨重</code>。Docker是不携带操作系统的，所以Docker的应用就非常的轻巧。另外在调用宿主机的CPU、磁盘等等这些资源的时候，拿内存举例，虚拟机是利用Hypervisor去虚拟化内存，整个调用过程是虚拟内存-&gt;虚拟物理内存-&gt;真正物理内存，但是Docker是利用Docker Engine去调用宿主的的资源，这时候过程是虚拟内存-&gt;真正物理内存。</p>
<table>
<thead>
<tr>
<th></th>
<th>传统虚拟机</th>
<th>Docker容器</th>
</tr>
</thead>
<tbody>
<tr>
<td>磁盘占用</td>
<td>几个GB到几十个GB左右</td>
<td>几十MB到几百MB左右</td>
</tr>
<tr>
<td>CPU内存占用</td>
<td>虚拟操作系统非常占用CPU和内存</td>
<td>Docker引擎占用极低</td>
</tr>
<tr>
<td>启动速度</td>
<td>（从开机到运行项目）几分钟</td>
<td>（从开启容器到运行项目）几秒</td>
</tr>
<tr>
<td>安装管理</td>
<td>需要专门的运维技术</td>
<td>安装、管理方便</td>
</tr>
<tr>
<td>应用部署</td>
<td>每次部署都费时费力</td>
<td>从第二次部署开始轻松简捷</td>
</tr>
<tr>
<td>耦合性</td>
<td>多个应用服务安装到一起，容易互相影响</td>
<td>每个应用服务一个容器，达成隔离</td>
</tr>
<tr>
<td>系统依赖</td>
<td>无</td>
<td>需求相同或相似的内核，目前推荐是Linux</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="4docker的安装">4.Docker的安装<a class="anchor ms-1" href="#4docker的安装"><i class="fas fa-link"></i></a></h2>
<h3 id="41-安装dockercentos7x">4.1 安装docker(centos7.x)<a class="anchor ms-1" href="#41-安装dockercentos7x"><i class="fas fa-link"></i></a></h3>
<ul>
<li>
<p>卸载原始docker</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl">$ sudo yum remove docker <span class="se">\
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="se"></span>                  docker-client <span class="se">\
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="se"></span>                  docker-client-latest <span class="se">\
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="se"></span>                  docker-common <span class="se">\
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="se"></span>                  docker-latest <span class="se">\
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="se"></span>                  docker-latest-logrotate <span class="se">\
</span></span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="se"></span>                  docker-logrotate <span class="se">\
</span></span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="se"></span>                  docker-engine
</span></span></code></pre></div></li>
<li>
<p>安装docker依赖</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl">$ sudo yum install -y yum-utils <span class="se">\
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="se"></span>  device-mapper-persistent-data <span class="se">\
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="se"></span>  lvm2
</span></span></code></pre></div></li>
<li>
<p>设置docker的yum源</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">$ sudo yum-config-manager <span class="se">\
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="se"></span>    --add-repo <span class="se">\
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="se"></span>    https://download.docker.com/linux/centos/docker-ce.repo
</span></span></code></pre></div></li>
<li>
<p>安装最新版的docker</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">$ sudo yum install docker-ce docker-ce-cli containerd.io
</span></span></code></pre></div></li>
<li>
<p>指定版本安装docker</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">$ yum list docker-ce --showduplicates <span class="p">|</span> sort -r
</span></span><span class="line"><span class="ln">2</span><span class="cl">$ sudo yum install docker-ce-&lt;VERSION_STRING&gt; docker-ce-cli-&lt;VERSION_STRING&gt; containerd.io
</span></span><span class="line"><span class="ln">3</span><span class="cl">$ sudo yum install docker-ce-18.09.5-3.el7 docker-ce-cli-18.09.5-3.el7 containerd.io
</span></span></code></pre></div></li>
<li>
<p>启动docker</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">$ sudo systemctl <span class="nb">enable</span> docker
</span></span><span class="line"><span class="ln">2</span><span class="cl">$ sudo systemctl start docker
</span></span></code></pre></div></li>
<li>
<p>关闭docker</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">$ sudo systemctl stop docker
</span></span></code></pre></div></li>
<li>
<p>测试docker安装</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">$ sudo docker run hello-world
</span></span></code></pre></div></li>
</ul>
<h3 id="42-bash安装通用所有平台">4.2 bash安装(通用所有平台)<a class="anchor ms-1" href="#42-bash安装通用所有平台"><i class="fas fa-link"></i></a></h3>
<ul>
<li>
<p>在测试或开发环境中 Docker 官方为了简化安装流程，提供了一套便捷的安装脚本，CentOS 系统上可以使用这套脚本安装，另外可以通过 <code>--mirror</code> 选项使用国内源进行安装：执行这个命令后，脚本就会自动的将一切准备工作做好，并且把 Docker 的稳定(stable)版本安装在系统中。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">$ curl -fsSL get.docker.com -o get-docker.sh
</span></span><span class="line"><span class="ln">2</span><span class="cl">$ sudo sh get-docker.sh --mirror Aliyun
</span></span></code></pre></div></li>
<li>
<p>启动docker</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">$ sudo systemctl <span class="nb">enable</span> docker
</span></span><span class="line"><span class="ln">2</span><span class="cl">$ sudo systemctl start docker
</span></span></code></pre></div></li>
<li>
<p>创建docker用户组</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">$ sudo groupadd docker
</span></span></code></pre></div></li>
<li>
<p>将当前用户加入docker组</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">$ sudo usermod -aG docker <span class="nv">$USER</span>
</span></span></code></pre></div></li>
<li>
<p>测试docker安装是否正确</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">$ docker run hello-world
</span></span></code></pre></div></li>
</ul>
<h2 id="5docker-的核心架构">5.Docker 的核心架构<a class="anchor ms-1" href="#5docker-的核心架构"><i class="fas fa-link"></i></a></h2>
<p><picture><img class="img-fluid" alt="image-20200404111908085" src="/posts/ddeb9b11/index/image-20200404111908085-0291323.png" loading="lazy"
    
     />
</picture>

</p>
<ul>
<li><code>镜像:</code> 一个镜像代表一个应用环境,他是一个只读的文件,如 mysql镜像,tomcat镜像,nginx镜像等</li>
<li><code>容器:</code> 镜像每次运行之后就是产生一个容器,就是正在运行的镜像,特点就是可读可写</li>
<li><code>仓库:</code>用来存放镜像的位置,类似于maven仓库,也是镜像下载和上传的位置</li>
<li><code>dockerFile:</code>docker生成镜像配置文件,用来书写自定义镜像的一些配置</li>
<li><code>tar:</code>一个对镜像打包的文件,日后可以还原成镜像</li>
</ul>
<h2 id="6-docker-配置阿里镜像加速服务">6. Docker 配置阿里镜像加速服务<a class="anchor ms-1" href="#6-docker-配置阿里镜像加速服务"><i class="fas fa-link"></i></a></h2>
<h3 id="61-docker-运行流程">6.1 docker 运行流程<a class="anchor ms-1" href="#61-docker-运行流程"><i class="fas fa-link"></i></a></h3>
<p><picture><img class="img-fluid" alt="image-20200404120356784" src="/posts/ddeb9b11/index/image-20200404120356784.png" loading="lazy"
    
     />
</picture>

</p>
<h3 id="62-docker配置阿里云镜像加速">6.2 docker配置阿里云镜像加速<a class="anchor ms-1" href="#62-docker配置阿里云镜像加速"><i class="fas fa-link"></i></a></h3>
<ul>
<li><code>访问阿里云登录自己账号查看docker镜像加速服务</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl">sudo mkdir -p /etc/docker
</span></span><span class="line"><span class="ln">2</span><span class="cl">sudo tee /etc/docker/daemon.json <span class="s">&lt;&lt;-&#39;EOF&#39;
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="s">{
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="s">  &#34;registry-mirrors&#34;: [&#34;https://lz2nib3q.mirror.aliyuncs.com&#34;]
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="s">}
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">sudo systemctl daemon-reload
</span></span><span class="line"><span class="ln">8</span><span class="cl">sudo systemctl restart docker
</span></span></code></pre></div><ul>
<li><code>验证docker的镜像加速是否生效</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># docker info</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">		..........
</span></span><span class="line"><span class="ln">3</span><span class="cl">    127.0.0.0/8
</span></span><span class="line"><span class="ln">4</span><span class="cl">   Registry Mirrors:
</span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="s1">&#39;https://lz2nib3q.mirror.aliyuncs.com/&#39;</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">   Live Restore Enabled: <span class="nb">false</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">   Product License: Community Engine
</span></span></code></pre></div><hr>
<h2 id="7docker的入门应用">7.Docker的入门应用<a class="anchor ms-1" href="#7docker的入门应用"><i class="fas fa-link"></i></a></h2>
<h3 id="71-docker-的第一个程序">7.1 docker 的第一个程序<a class="anchor ms-1" href="#71-docker-的第一个程序"><i class="fas fa-link"></i></a></h3>
<blockquote>
<p>docker  run hello-world</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># docker run hello-world</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">Hello from Docker!
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">This message shows that your installation appears to be working correctly.
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">To generate this message, Docker took the following steps:
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"> 1. The Docker client contacted the Docker daemon.
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"> 2. The Docker daemon pulled the <span class="s2">&#34;hello-world&#34;</span> image from the Docker Hub.
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="o">(</span>amd64<span class="o">)</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"> 3. The Docker daemon created a new container from that image which runs the
</span></span><span class="line"><span class="ln">11</span><span class="cl">    executable that produces the output you are currently reading.
</span></span><span class="line"><span class="ln">12</span><span class="cl"> 4. The Docker daemon streamed that output to the Docker client, which sent it
</span></span><span class="line"><span class="ln">13</span><span class="cl">    to your terminal.
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl">To try something more ambitious, you can run an Ubuntu container with:
</span></span><span class="line"><span class="ln">16</span><span class="cl"> $ docker run -it ubuntu bash
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl">Share images, automate workflows, and more with a free Docker ID:
</span></span><span class="line"><span class="ln">19</span><span class="cl"> https://hub.docker.com/
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl">For more examples and ideas, visit:
</span></span><span class="line"><span class="ln">22</span><span class="cl"> https://docs.docker.com/get-started/
</span></span></code></pre></div><hr>
<h2 id="8常用命令">8.常用命令<a class="anchor ms-1" href="#8常用命令"><i class="fas fa-link"></i></a></h2>
<h3 id="61-辅助命令">6.1 辅助命令<a class="anchor ms-1" href="#61-辅助命令"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl"><span class="gh"># 1.安装完成辅助命令
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="gh"></span>		docker version	--------------------------	查看docker的信息
</span></span><span class="line"><span class="ln">3</span><span class="cl">		docker info		--------------------------	查看更详细的信息
</span></span><span class="line"><span class="ln">4</span><span class="cl">		docker --help	--------------------------	帮助命令
</span></span></code></pre></div><h3 id="62-images-镜像命令">6.2 Images 镜像命令<a class="anchor ms-1" href="#62-images-镜像命令"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="gh"># 1.查看本机中所有镜像
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="gh"></span>	docker images	--------------------------	列出本地所有镜像
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">		-a			列出所有镜像（包含中间映像层）
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">  	-q			只显示镜像id
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="gh"># 2.搜索镜像
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="gh"></span>	docker search [options] 镜像名	-------------------	去dockerhub上查询当前镜像
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">		-s 指定值		列出收藏数不少于指定值的镜像
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">  	--no-trunc	  显示完整的镜像信息
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="gh"># 3.从仓库下载镜像
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="gh"></span>	docker pull 镜像名[:TAG|@DIGEST]	----------------- 下载镜像
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="gh"># 4.删除镜像
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="gh"></span>	docker rmi 镜像名	--------------------------  删除镜像
</span></span><span class="line"><span class="ln">16</span><span class="cl">		-f		强制删除
</span></span></code></pre></div><h3 id="63-contrainer-容器命令">6.3 Contrainer 容器命令<a class="anchor ms-1" href="#63-contrainer-容器命令"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="gh"># 1.运行容器
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="gh"></span>	docker run 镜像名	--------------------------	镜像名新建并启动容器
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    --name 					别名为容器起一个名字
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    -d							启动守护式容器（在后台启动容器）
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    -p 							映射端口号：原始端口号		 指定端口号启动
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">	例：docker run -it --name myTomcat -p 8888:8080 tomcat
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">   	 docker run -d --name myTomcat -P tomcat
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="gh"># 2.查看运行的容器
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="gh"></span>	docker ps					--------------------------	列出所有正在运行的容器
</span></span><span class="line"><span class="ln">12</span><span class="cl">	-a			正在运行的和历史运行过的容器
</span></span><span class="line"><span class="ln">13</span><span class="cl">	-q			静默模式，只显示容器编号
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="gh"># 3.停止|关闭|重启容器
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="gh"></span>	docker start   容器名字或者容器id  --------------- 开启容器
</span></span><span class="line"><span class="ln">17</span><span class="cl">	docker restart 容器名或者容器id    --------------- 重启容器
</span></span><span class="line"><span class="ln">18</span><span class="cl">	docker stop  容器名或者容器id 	    ------------------ 正常停止容器运行
</span></span><span class="line"><span class="ln">19</span><span class="cl">	docker kill  容器名或者容器id      ------------------ 立即停止容器运行
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="gh"># 4.删除容器
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="gh"></span>	docker rm -f 容器id和容器名     
</span></span><span class="line"><span class="ln">23</span><span class="cl">	docker rm -f $(docker ps -aq)		--------------------------	删除所有容器
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="gh"># 5.查看容器内进程
</span></span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="gh"></span>	docker top 容器id或者容器名 ------------------ 查看容器内的进程
</span></span><span class="line"><span class="ln">27</span><span class="cl">
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="gh"># 6.查看查看容器内部细节
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="gh"></span>	docker inspect 容器id 		------------------ 查看容器内部细节
</span></span><span class="line"><span class="ln">30</span><span class="cl">
</span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="gh"># 7.查看容器的运行日志
</span></span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="gh"></span>	docker logs [OPTIONS] 容器id或容器名	------------------ 查看容器日志
</span></span><span class="line"><span class="ln">33</span><span class="cl">    -t			 加入时间戳
</span></span><span class="line"><span class="ln">34</span><span class="cl">    -f			 跟随最新的日志打印
</span></span><span class="line"><span class="ln">35</span><span class="cl">    --tail 	 数字	显示最后多少条
</span></span><span class="line"><span class="ln">36</span><span class="cl">
</span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="gh"># 8.进入容器内部
</span></span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="gh"></span>	docker exec [options] 容器id 容器内命令 ------------------ 进入容器执行命令
</span></span><span class="line"><span class="ln">39</span><span class="cl">		-i		以交互模式运行容器，通常与-t一起使用
</span></span><span class="line"><span class="ln">40</span><span class="cl">    -t		分配一个伪终端    shell窗口   bash 
</span></span><span class="line"><span class="ln">41</span><span class="cl">
</span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="gh"># 9.容器和宿主机之间复制文件
</span></span></span><span class="line"><span class="ln">43</span><span class="cl"><span class="gh"></span>	docker cp 文件|目录 容器id:容器路径           -----------------   将宿主机复制到容器内部
</span></span><span class="line"><span class="ln">44</span><span class="cl">	docker cp 容器id:容器内资源路径 宿主机目录路径  -----------------   将容器内资源拷贝到主机上
</span></span><span class="line"><span class="ln">45</span><span class="cl">
</span></span><span class="line"><span class="ln">46</span><span class="cl"><span class="gh"># 10.数据卷(volum)实现与宿主机共享目录
</span></span></span><span class="line"><span class="ln">47</span><span class="cl"><span class="gh"></span>	docker run -v 宿主机的路径|任意别名:/容器内的路径 镜像名
</span></span><span class="line"><span class="ln">48</span><span class="cl">		注意: 
</span></span><span class="line"><span class="ln">49</span><span class="cl">				1.如果是宿主机路径必须是绝对路径,宿主机目录会覆盖容器内目录内容
</span></span><span class="line"><span class="ln">50</span><span class="cl">				2.如果是别名则会在docker运行容器时自动在宿主机中创建一个目录,并将容器目录文件复制到宿主机中
</span></span><span class="line"><span class="ln">51</span><span class="cl">
</span></span><span class="line"><span class="ln">52</span><span class="cl"><span class="gh"># 11.打包镜像
</span></span></span><span class="line"><span class="ln">53</span><span class="cl"><span class="gh"></span>		docker save 镜像名 -o  名称.tar
</span></span><span class="line"><span class="ln">54</span><span class="cl">
</span></span><span class="line"><span class="ln">55</span><span class="cl"><span class="gh"># 12.载入镜像
</span></span></span><span class="line"><span class="ln">56</span><span class="cl"><span class="gh"></span>		docker load -i   名称.tar
</span></span><span class="line"><span class="ln">57</span><span class="cl">
</span></span><span class="line"><span class="ln">58</span><span class="cl"><span class="gh"># 13.容器打包成新的镜像
</span></span></span><span class="line"><span class="ln">59</span><span class="cl"><span class="gh"></span>	  docker commit -m &#34;描述信息&#34; -a &#34;作者信息&#34;   （容器id或者名称）打包的镜像名称:标签
</span></span></code></pre></div><hr>
<h2 id="7docker的镜像原理">7.docker的镜像原理<a class="anchor ms-1" href="#7docker的镜像原理"><i class="fas fa-link"></i></a></h2>
<h3 id="71-镜像是什么">7.1 镜像是什么？<a class="anchor ms-1" href="#71-镜像是什么"><i class="fas fa-link"></i></a></h3>
<blockquote>
<p>镜像是一种轻量级的，可执行的独立软件包，用来打包软件运行环境和基于运行环境开发的软件，它包含运行某个软件所需的所有内容，包括代码、运行时所需的库、环境变量和配置文件。</p>
</blockquote>
<h3 id="72-为什么一个镜像会那么大">7.2 为什么一个镜像会那么大？<a class="anchor ms-1" href="#72-为什么一个镜像会那么大"><i class="fas fa-link"></i></a></h3>
<p><picture><img class="img-fluid" alt="image-20200404142950068" src="/posts/ddeb9b11/index/image-20200404142950068.png" loading="lazy"
    
     />
</picture>

</p>
<p><code>镜像就是花卷</code></p>
<ul>
<li>
<p>UnionFS（联合文件系统）:</p>
<p>Union文件系统是一种分层，轻量级并且高性能的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下。Union文件系统是Docker镜像的基础。这种文件系统特性:就是一次同时加载多个文件系统，但从外面看起来，只能看到一个文件系统，联合加载会把各层文件系统叠加起来，这样最终的文件系统会包含所有底层的文件和目录 。</p>
</li>
</ul>
<h3 id="73-docker镜像原理">7.3 Docker镜像原理<a class="anchor ms-1" href="#73-docker镜像原理"><i class="fas fa-link"></i></a></h3>
<blockquote>
<p><code>docker的镜像实际是由一层一层的文件系统组成。</code></p>
</blockquote>
<ul>
<li>
<p>bootfs（boot file system）主要包含bootloader和kernel，bootloader主要是引导加载kernel，Linux刚启动时会加载bootfs文件系统。在docker镜像的最底层就是bootfs。这一层与Linux/Unix 系统是一样的，包含boot加载器（bootloader）和内核（kernel）。当boot加载完,后整个内核就都在内存中了，此时内存的使用权已由bootfs转交给内核，此时会卸载bootfs。</p>
</li>
<li>
<p>rootfs（root file system），在bootfs之上，包含的就是典型的linux系统中的/dev，/proc，/bin，/etc等标准的目录和文件。rootfs就是各种不同的操作系统发行版，比如Ubuntu/CentOS等等。</p>
</li>
<li>
<p>我们平时安装进虚拟机的centos都有1到几个GB，为什么docker这里才200MB？对于一个精简的OS，rootfs可以很小，只需要包括最基本的命令，工具，和程序库就可以了，因为底层直接使用Host的Kernal，自己只需要提供rootfs就行了。由此可见不同的linux发行版，他们的bootfs是一致的，rootfs会有差别。因此不同的发行版可以共用bootfs。</p>
</li>
</ul>
<p><picture><img class="img-fluid" alt="" src="/posts/ddeb9b11/index/1567585172%281%29.jpg" loading="lazy"
    
     />
</picture>

</p>
<h3 id="74-为什么docker镜像要采用这种分层结构呢">7.4 为什么docker镜像要采用这种分层结构呢?<a class="anchor ms-1" href="#74-为什么docker镜像要采用这种分层结构呢"><i class="fas fa-link"></i></a></h3>
<blockquote>
<p><code>最大的一个好处就是资源共享</code></p>
</blockquote>
<ul>
<li>比如：有多个镜像都是从相同的base镜像构建而来的，那么宿主机只需在磁盘中保存一份base镜像。同时内存中也只需要加载一份base镜像，就可以为所有容器服务了。而且镜像的每一层都可以被共享。Docker镜像都是只读的。当容器启动时，一个新的可写层被加载到镜像的顶部。这一层通常被称为容器层，容器层之下都叫镜像层。</li>
</ul>
<hr>
<h2 id="8docker安装常用服务">8.Docker安装常用服务<a class="anchor ms-1" href="#8docker安装常用服务"><i class="fas fa-link"></i></a></h2>
<h3 id="81-安装mysql">8.1 安装mysql<a class="anchor ms-1" href="#81-安装mysql"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="gh"># 1.拉取mysql镜像到本地
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="gh"></span>	docker pull mysql:tag (tag不加默认最新版本)
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">	
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="gh"># 2.运行mysql服务
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="gh"></span>	docker run --name mysql -e MYSQL_ROOT_PASSWORD=root -d mysql:tag  						  --没有暴露外部端口外部不能连接
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">	docker run --name mysql -e MYSQL_ROOT_PASSWORD=root -p 3306:3306 -d  mysql:tag  --没有暴露外部端口
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="gh"># 3.进入mysql容器
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="gh"></span>	docker exec -it 容器名称|容器id bash
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="gh"># 4.外部查看mysql日志
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="gh"></span>	docker logs 容器名称|容器id
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="gh"># 5.使用自定义配置参数
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="gh"></span>	docker run --name mysql -v /root/mysql/conf.d:/etc/mysql/conf.d -e MYSQL_ROOT_PASSWORD=root -d mysql:tag
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="gh"># 6.将容器数据位置与宿主机位置挂载保证数据安全
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="gh"></span>	docker run --name mysql -v /root/mysql/data:/var/lib/mysql -v /root/mysql/conf.d:/etc/mysql/conf.d -e MYSQL_ROOT_PASSWORD=root -p 3306:3306 -d mysql:tag
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="gh"># 7.通过其他客户端访问 如在window系统|macos系统使用客户端工具访问
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="gh"></span>	
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="gh"># 8.将mysql数据库备份为sql文件
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="gh"></span>	docker exec mysql|容器id sh -c &#39;exec mysqldump --all-databases -uroot -p&#34;$MYSQL_ROOT_PASSWORD&#34;&#39; &gt; /root/all-databases.sql  --导出全部数据
</span></span><span class="line"><span class="ln">24</span><span class="cl">	docker exec mysql sh -c &#39;exec mysqldump --databases 库表 -uroot -p&#34;$MYSQL_ROOT_PASSWORD&#34;&#39; &gt; /root/all-databases.sql  --导出指定库数据
</span></span><span class="line"><span class="ln">25</span><span class="cl">	docker exec mysql sh -c &#39;exec mysqldump --no-data --databases 库表 -uroot -p&#34;$MYSQL_ROOT_PASSWORD&#34;&#39; &gt; /root/all-databases.sql  --导出指定库数据不要数据
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="gh"># 9.执行sql文件到mysql中
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="gh"></span>	docker exec -i mysql sh -c &#39;exec mysql -uroot -p&#34;$MYSQL_ROOT_PASSWORD&#34;&#39; <span class="err">&lt;</span> /root/xxx.sql
</span></span></code></pre></div><h3 id="82-安装redis服务">8.2 安装Redis服务<a class="anchor ms-1" href="#82-安装redis服务"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="gh"># 1.在docker hub搜索redis镜像
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="gh"></span>	docker search redis
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="gh"># 2.拉取redis镜像到本地
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="gh"></span>	docker pull redis
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="gh"># 3.启动redis服务运行容器
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="gh"></span>	docker run --name redis -d redis:tag (没有暴露外部端口)
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">	docker run --name redis -p 6379:6379 -d redis:tag (暴露外部宿主机端口为6379进行连接) 
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="gh"># 4.查看启动日志
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="gh"></span>	docker logs -t -f 容器id|容器名称
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="gh"># 5.进入容器内部查看
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="gh"></span>	docker exec -it 容器id|名称 bash  
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="gh"># 6.加载外部自定义配置启动redis容器
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="gh"></span>	默认情况下redis官方镜像中没有redis.conf配置文件 需要去官网下载指定版本的配置文件
</span></span><span class="line"><span class="ln">19</span><span class="cl">	<span class="k">1.</span> wget http://download.redis.io/releases/redis-5.0.8.tar.gz  下载官方安装包
</span></span><span class="line"><span class="ln">20</span><span class="cl">	<span class="k">2.</span> 将官方安装包中配置文件进行复制到宿主机指定目录中如 /root/redis/redis.conf文件
</span></span><span class="line"><span class="ln">21</span><span class="cl">	<span class="k">3.</span> 修改需要自定义的配置
</span></span><span class="line"><span class="ln">22</span><span class="cl">		 bind 0.0.0.0 开启远程权限
</span></span><span class="line"><span class="ln">23</span><span class="cl">		 appenonly yes 开启aof持久化
</span></span><span class="line"><span class="ln">24</span><span class="cl">	<span class="k">4.</span> 加载配置启动
</span></span><span class="line"><span class="ln">25</span><span class="cl">	docker run --name redis -v /root/redis:/usr/local/etc/redis -p 6379:6379 -d redis redis-server /usr/local/etc/redis/redis.conf  
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="gh"># 7.将数据目录挂在到本地保证数据安全
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="gh"></span>	docker run --name redis -v /root/redis/data:/data -v /root/redis/redis.conf:/usr/local/etc/redis/redis.conf -p 6379:6379 -d redis redis-server 					/usr/local/etc/redis/redis.conf  
</span></span></code></pre></div><h3 id="83-安装nginx">8.3 安装Nginx<a class="anchor ms-1" href="#83-安装nginx"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="gh"># 1.在docker hub搜索nginx
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="gh"></span>	docker search nginx
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="gh"># 2.拉取nginx镜像到本地
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="gh"></span>	[root@localhost ~]# docker pull nginx
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    Using default tag: latest
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    latest: Pulling from library/nginx
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    afb6ec6fdc1c: Pull complete 
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    b90c53a0b692: Pull complete 
</span></span><span class="line"><span class="ln">10</span><span class="cl">    11fa52a0fdc0: Pull complete 
</span></span><span class="line"><span class="ln">11</span><span class="cl">    Digest: sha256:30dfa439718a17baafefadf16c5e7c9d0a1cde97b4fd84f63b69e13513be7097
</span></span><span class="line"><span class="ln">12</span><span class="cl">    Status: Downloaded newer image for nginx:latest
</span></span><span class="line"><span class="ln">13</span><span class="cl">    docker.io/library/nginx:latest
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="gh"># 3.启动nginx容器
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="gh"></span>		docker run -p 80:80 --name nginx01 -d nginx
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="gh"># 4.进入容器
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="gh"></span>		docker exec -it nginx01 /bin/bash
</span></span><span class="line"><span class="ln">20</span><span class="cl">		查找目录:  whereis nginx
</span></span><span class="line"><span class="ln">21</span><span class="cl">		配置文件:  /etc/nginx/nginx.conf
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="gh"># 5.复制配置文件到宿主机
</span></span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="gh"></span>		docker cp nginx01(容器id|容器名称):/etc/nginx/nginx.conf 宿主机名录
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="gh"># 6.挂在nginx配置以及html到宿主机外部
</span></span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="gh"></span>		docker run --name nginx02 -v /root/nginx/nginx.conf:/etc/nginx/nginx.conf -v /root/nginx/html:/usr/share/nginx/html -p 80:80 -d nginx		
</span></span></code></pre></div><hr>
<h3 id="84-安装tomcat">8.4 安装Tomcat<a class="anchor ms-1" href="#84-安装tomcat"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="gh"># 1.在docker hub搜索tomcat
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="gh"></span>	docker search tomcat
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="gh"># 2.下载tomcat镜像
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="gh"></span>	docker pull tomcat
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="gh"># 3.运行tomcat镜像
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="gh"></span>	docker run -p 8080:8080 -d --name mytomcat tomcat
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="gh"># 4.进入tomcat容器
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="gh"></span>	docker exec -it mytomcat /bin/bash
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="gh"># 5.将webapps目录挂载在外部
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="gh"></span>	docker run -p 8080:8080 -v /root/webapps:/usr/local/tomcat/webapps -d --name mytomcat tomcat
</span></span></code></pre></div><hr>
<h3 id="85-安装mongodb数据库">8.5 安装MongoDB数据库<a class="anchor ms-1" href="#85-安装mongodb数据库"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="gh"># 1.运行mongDB
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="gh"></span>	docker run -d -p 27017:27017 --name mymongo mongo  ---无须权限
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">	docker logs -f mymongo --查看mongo运行日志
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="gh"># 2.进入mongodb容器
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="gh"></span>	docker exec -it mymongo /bin/bash
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">		直接执行mongo命令进行操作
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="gh"># 3.常见具有权限的容器
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="gh"></span>	docker run --name  mymongo  -p 27017:27017  -d mongo --auth
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="gh"># 4.进入容器配置用户名密码
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="gh"></span>	mongo
</span></span><span class="line"><span class="ln">14</span><span class="cl">	use admin 选择admin库
</span></span><span class="line"><span class="ln">15</span><span class="cl">	db.createUser({user:&#34;root&#34;,pwd:&#34;root&#34;,roles:[{role:&#39;root&#39;,db:&#39;admin&#39;}]})   //创建用户,此用户创建成功,则后续操作都需要用户认证
</span></span><span class="line"><span class="ln">16</span><span class="cl">	exit
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="gh"># 5.将mongoDB中数据目录映射到宿主机中
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="gh"></span>	docker run -d -p 27017:27017 -v /root/mongo/data:/data/db --name mymongo mongo 
</span></span></code></pre></div><h3 id="86-安装elasticsearch">8.6 安装ElasticSearch<a class="anchor ms-1" href="#86-安装elasticsearch"><i class="fas fa-link"></i></a></h3>
<ul>
<li><code>注意:</code><strong>调高JVM线程数限制数量</strong></li>
</ul>
<h4 id="0拉取镜像运行elasticsearch">0.拉取镜像运行elasticsearch<a class="anchor ms-1" href="#0拉取镜像运行elasticsearch"><i class="fas fa-link"></i></a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl"><span class="gh"># 1.dockerhub 拉取镜像
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="gh"></span>	docker pull elasticsearch:6.4.2
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="gh"># 2.查看docker镜像
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="gh"></span>	docker images
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="gh"># 3.运行docker镜像
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="gh"></span>	docker run -p 9200:9200 -p 9300:9300 elasticsearch:6.4.2
</span></span></code></pre></div><ul>
<li>启动出现如下错误</li>
<li><picture><img class="img-fluid" alt="image-20200602184321790" src="/posts/ddeb9b11/index/image-20200602184321790.png" loading="lazy"
    
     />
</picture>

</li>
</ul>
<h4 id="1-预先配置">1. 预先配置<a class="anchor ms-1" href="#1-预先配置"><i class="fas fa-link"></i></a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl"><span class="gh"># 1.在centos虚拟机中，修改配置sysctl.conf
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="gh"></span>	vim /etc/sysctl.conf
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="gh"># 2.加入如下配置
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="gh"></span>	vm.max_map_count=262144 
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="gh"># 3.启用配置
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="gh"></span>	sysctl -p
</span></span><span class="line"><span class="ln">7</span><span class="cl">	注：这一步是为了防止启动容器时，报出如下错误：
</span></span><span class="line"><span class="ln">8</span><span class="cl">	bootstrap checks failed max virtual memory areas vm.max_map_count [65530] likely too low, increase to at least [262144]
</span></span></code></pre></div><h4 id="2启动eleasticsearch容器">2.启动EleasticSearch容器<a class="anchor ms-1" href="#2启动eleasticsearch容器"><i class="fas fa-link"></i></a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl"><span class="gh"># 0.复制容器中data目录到宿主机中
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="gh"></span>	docker cp 容器id:/usr/share/share/elasticsearch/data /root/es
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="gh"># 1.运行ES容器 指定jvm内存大小并指定ik分词器位置
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="gh"></span>	docker run -d --name es -p 9200:9200 -p 9300:9300 -e ES_JAVA_OPTS=&#34;-Xms128m -Xmx128m&#34; -v /root/es/plugins:/usr/share/elasticsearch/plugins -v /root/es/data:/usr/share/elasticsearch/data elasticsearch:6.4.2
</span></span></code></pre></div><h4 id="3安装ik分词器">3.安装IK分词器<a class="anchor ms-1" href="#3安装ik分词器"><i class="fas fa-link"></i></a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="gh"># 1.下载对应版本的IK分词器
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="gh"></span>	wget https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v6.4.2/elasticsearch-analysis-ik-6.4.2.zip
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="gh"># 2.解压到plugins文件夹中
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="gh"></span>	yum install -y unzip
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">	unzip -d ik elasticsearch-analysis-ik-6.4.2.zip
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="gh"># 3.添加自定义扩展词和停用词
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="gh"></span>	cd plugins/elasticsearch/config
</span></span><span class="line"><span class="ln">10</span><span class="cl">	vim IKAnalyzer.cfg.xml
</span></span><span class="line"><span class="ln">11</span><span class="cl">	<span class="p">&lt;</span><span class="nt">properties</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">		<span class="p">&lt;</span><span class="nt">comment</span><span class="p">&gt;</span>IK Analyzer 扩展配置<span class="p">&lt;/</span><span class="nt">comment</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">		<span class="c">&lt;!--用户可以在这里配置自己的扩展字典 --&gt;</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">		<span class="p">&lt;</span><span class="nt">entry</span> <span class="na">key</span><span class="o">=</span><span class="s">&#34;ext_dict&#34;</span><span class="p">&gt;</span>ext_dict.dic<span class="p">&lt;/</span><span class="nt">entry</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">		<span class="c">&lt;!--用户可以在这里配置自己的扩展停止词字典--&gt;</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">		<span class="p">&lt;</span><span class="nt">entry</span> <span class="na">key</span><span class="o">=</span><span class="s">&#34;ext_stopwords&#34;</span><span class="p">&gt;</span>ext_stopwords.dic<span class="p">&lt;/</span><span class="nt">entry</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">	<span class="p">&lt;/</span><span class="nt">properties</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="gh"># 4.在ik分词器目录下config目录中创建ext_dict.dic文件   编码一定要为UTF-8才能生效
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="gh"></span>	vim ext_dict.dic 加入扩展词即可
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="gh"># 5. 在ik分词器目录下config目录中创建ext_stopword.dic文件 
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="gh"></span>	vim ext_stopwords.dic 加入停用词即可
</span></span><span class="line"><span class="ln">23</span><span class="cl">
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="gh"># 6.重启容器生效
</span></span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="gh"></span>	docker restart 容器id
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="gh"># 7.将此容器提交成为一个新的镜像
</span></span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="gh"></span>	docker commit -a=&#34;xiaochen&#34; -m=&#34;es with IKAnalyzer&#34; 容器id xiaochen/elasticsearch:6.4.2
</span></span></code></pre></div><h4 id="4-安装kibana">4. 安装Kibana<a class="anchor ms-1" href="#4-安装kibana"><i class="fas fa-link"></i></a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl"><span class="gh"># 1.下载kibana镜像到本地
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="gh"></span>	docker pull kibana:6.4.2
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="gh"># 2.启动kibana容器
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="gh"></span>	docker run -d --name kibana -e ELASTICSEARCH_URL=http://10.15.0.3:9200 -p 5601:5601 kibana:6.4.2
</span></span></code></pre></div><hr>
<h2 id="10docker中出现如下错误解决方案">10.Docker中出现如下错误解决方案<a class="anchor ms-1" href="#10docker中出现如下错误解决方案"><i class="fas fa-link"></i></a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="ln">1</span><span class="cl"><span class="p">[</span><span class="n">root</span><span class="nv">@localhost</span> <span class="p">~]</span><span class="c"># docker search mysql 或者 docker pull 这些命令无法使用</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">Error</span> <span class="n">response</span> <span class="n">from</span> <span class="n">daemon</span><span class="err">:</span> <span class="n">Get</span> <span class="n">https</span><span class="err">:</span><span class="p">//</span><span class="n">index</span><span class="p">.</span><span class="n">docker</span><span class="p">.</span><span class="n">io</span><span class="p">/</span><span class="n">v1</span><span class="p">/</span><span class="n">search</span><span class="k">?</span><span class="n">q</span><span class="p">=</span><span class="n">mysql</span><span class="p">&amp;</span><span class="n">n</span><span class="p">=</span><span class="n">25</span><span class="err">:</span> <span class="n">x509</span><span class="err">:</span> <span class="n">certificate</span> <span class="n">has</span> <span class="n">expired</span> <span class="n">or</span> <span class="n">is</span> <span class="n">not</span> <span class="n">yet</span> <span class="n">valid</span>
</span></span></code></pre></div><p><picture><img class="img-fluid" alt="image-20200602183429286" src="/posts/ddeb9b11/index/image-20200602183429286.png" loading="lazy"
    
     />
</picture>

</p>
<ul>
<li>注意:<strong>这个错误的原因在于是系统的时间和docker hub时间不一致,需要做系统时间与网络时间同步</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl"><span class="gh"># 1.安装时间同步
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="gh"></span>	sudo yum -y install ntp ntpdate
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="gh"># 2.同步时间
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="gh"></span>	sudo ntpdate cn.pool.ntp.org
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="gh"># 3.查看本机时间
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="gh"></span>	date
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="gh"># 4.从新测试
</span></span></span></code></pre></div><p><picture><img class="img-fluid" alt="image-20200602183718623" src="/posts/ddeb9b11/index/image-20200602183718623.png" loading="lazy"
    
     />
</picture>

</p>
<h2 id="9dockerfile">9.Dockerfile<a class="anchor ms-1" href="#9dockerfile"><i class="fas fa-link"></i></a></h2>
<h3 id="91-什么是dockerfile">9.1 什么是Dockerfile<a class="anchor ms-1" href="#91-什么是dockerfile"><i class="fas fa-link"></i></a></h3>
<p>Dockerfile可以认为是<strong>Docker镜像的描述文件，是由一系列命令和参数构成的脚本</strong>。主要作用是<strong>用来构建docker镜像的构建文件</strong>。</p>
<p><picture><img class="img-fluid" alt="image-20200404111908085" src="/posts/ddeb9b11/index/image-20200404111908085.png" loading="lazy"
    
     />
</picture>

</p>
<ul>
<li><strong>通过架构图可以看出通过DockerFile可以直接构建镜像</strong></li>
</ul>
<h3 id="92-dockerfile解析过程">9.2 Dockerfile解析过程<a class="anchor ms-1" href="#92-dockerfile解析过程"><i class="fas fa-link"></i></a></h3>
<p><picture><img class="img-fluid" alt="image-20200603181253804" src="/posts/ddeb9b11/index/image-20200603181253804.png" loading="lazy"
    
     />
</picture>

</p>
<h3 id="93-dockerfile的保留命令">9.3 Dockerfile的保留命令<a class="anchor ms-1" href="#93-dockerfile的保留命令"><i class="fas fa-link"></i></a></h3>
<p>官方说明:https://docs.docker.com/engine/reference/builder/</p>
<table>
<thead>
<tr>
<th>保留字</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>FROM</strong></td>
<td><strong>当前镜像是基于哪个镜像的</strong> <code>第一个指令必须是FROM</code></td>
</tr>
<tr>
<td>MAINTAINER</td>
<td>镜像维护者的姓名和邮箱地址</td>
</tr>
<tr>
<td><strong>RUN</strong></td>
<td><strong>构建镜像时需要运行的指令</strong></td>
</tr>
<tr>
<td><strong>EXPOSE</strong></td>
<td><strong>当前容器对外暴露出的端口号</strong></td>
</tr>
<tr>
<td><strong>WORKDIR</strong></td>
<td><strong>指定在创建容器后，终端默认登录进来的工作目录，一个落脚点</strong></td>
</tr>
<tr>
<td><strong>ENV</strong></td>
<td><strong>用来在构建镜像过程中设置环境变量</strong></td>
</tr>
<tr>
<td><strong>ADD</strong></td>
<td><strong>将宿主机目录下的文件拷贝进镜像且ADD命令会自动处理URL和解压tar包</strong></td>
</tr>
<tr>
<td><strong>COPY</strong></td>
<td><strong>类似于ADD，拷贝文件和目录到镜像中<br/>将从构建上下文目录中&lt;原路径&gt;的文件/目录复制到新的一层的镜像内的&lt;目标路径&gt;位置</strong></td>
</tr>
<tr>
<td><strong>VOLUME</strong></td>
<td><strong>容器数据卷，用于数据保存和持久化工作</strong></td>
</tr>
<tr>
<td><strong>CMD</strong></td>
<td><strong>指定一个容器启动时要运行的命令<br/>Dockerfile中可以有多个CMD指令，但只有最后一个生效，CMD会被docker run之后的参数替换</strong></td>
</tr>
<tr>
<td><strong>ENTRYPOINT</strong></td>
<td><strong>指定一个容器启动时要运行的命令<br/>ENTRYPOINT的目的和CMD一样，都是在指定容器启动程序及其参数</strong></td>
</tr>
</tbody>
</table>
<h4 id="931-from-命令">9.3.1 FROM 命令<a class="anchor ms-1" href="#931-from-命令"><i class="fas fa-link"></i></a></h4>
<ul>
<li>
<p>基于那个镜像进行构建新的镜像,在构建时会自动从docker hub拉取base镜像 必须作为Dockerfile的第一个指令出现</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">FROM</span><span class="s">  &lt;image&gt;</span><span class="err">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="err"></span><span class="k">FROM</span><span class="s">  &lt;image&gt;[:&lt;tag&gt;]     使用版本不写为latest</span><span class="err">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="err"></span><span class="k">FROM</span><span class="s">  &lt;image&gt;[@&lt;digest&gt;]  使用摘要</span><span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="932-maintainer--命令">9.3.2 MAINTAINER  命令<a class="anchor ms-1" href="#932-maintainer--命令"><i class="fas fa-link"></i></a></h4>
<ul>
<li>
<p>镜像维护者的姓名和邮箱地址[废弃]</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">MAINTAINER</span><span class="s"> &lt;name&gt;</span><span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="933-run-命令">9.3.3 RUN 命令<a class="anchor ms-1" href="#933-run-命令"><i class="fas fa-link"></i></a></h4>
<ul>
<li>
<p>RUN指令将在当前映像之上的新层中执行任何命令并提交结果。生成的提交映像将用于Dockerfile中的下一步</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">RUN</span> &lt;command&gt; <span class="o">(</span>shell form, the <span class="nb">command</span> is run in a shell, which by default is /bin/sh -c on Linux or cmd /S /C on Windows<span class="o">)</span><span class="err">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> hello<span class="err">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="o">[</span><span class="s2">&#34;executable&#34;</span>, <span class="s2">&#34;param1&#34;</span>, <span class="s2">&#34;param2&#34;</span><span class="o">]</span> <span class="o">(</span><span class="nb">exec</span> form<span class="o">)</span><span class="err">
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="o">[</span><span class="s2">&#34;/bin/bash&#34;</span>, <span class="s2">&#34;-c&#34;</span>, <span class="s2">&#34;echo hello&#34;</span><span class="o">]</span><span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="934-expose-命令">9.3.4 EXPOSE 命令<a class="anchor ms-1" href="#934-expose-命令"><i class="fas fa-link"></i></a></h4>
<ul>
<li>
<p>用来指定构建的镜像在运行为容器时对外暴露的端口</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">EXPOSE</span><span class="s"> 80/tcp  如果没有显示指定则默认暴露都是tcp</span><span class="err">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="err"></span><span class="k">EXPOSE</span><span class="s"> 80/udp</span><span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="935-cmd-命令">9.3.5 CMD 命令<a class="anchor ms-1" href="#935-cmd-命令"><i class="fas fa-link"></i></a></h4>
<ul>
<li>
<p>用来为启动的容器指定执行的命令,在Dockerfile中只能有一条CMD指令。如果列出多个命令，则只有最后一个命令才会生效。</p>
</li>
<li>
<p>注意: <strong>Dockerfile中只能有一条CMD指令。如果列出多个命令，则只有最后一个命令才会生效。</strong></p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">CMD</span> <span class="p">[</span><span class="s2">&#34;executable&#34;</span><span class="p">,</span><span class="s2">&#34;param1&#34;</span><span class="p">,</span><span class="s2">&#34;param2&#34;</span><span class="p">]</span> <span class="o">(</span><span class="nb">exec</span> form, this is the preferred form<span class="o">)</span><span class="err">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="err"></span><span class="k">CMD</span> <span class="p">[</span><span class="s2">&#34;param1&#34;</span><span class="p">,</span><span class="s2">&#34;param2&#34;</span><span class="p">]</span> <span class="o">(</span>as default parameters to ENTRYPOINT<span class="o">)</span><span class="err">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="err"></span><span class="k">CMD</span> <span class="nb">command</span> param1 param2 <span class="o">(</span>shell form<span class="o">)</span><span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="936-workdir-命令">9.3.6 WORKDIR 命令<a class="anchor ms-1" href="#936-workdir-命令"><i class="fas fa-link"></i></a></h4>
<ul>
<li>
<p>用来为Dockerfile中的任何RUN、CMD、ENTRYPOINT、COPY和ADD指令设置工作目录。如果WORKDIR不存在，即使它没有在任何后续Dockerfile指令中使用，它也将被创建。</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">WORKDIR</span><span class="s"> /path/to/workdir</span><span class="err">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /a</span><span class="err">
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> b</span><span class="err">
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> c</span><span class="err">
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="err"></span><span class="sb">`</span>注意:WORKDIR指令可以在Dockerfile中多次使用。如果提供了相对路径，则该路径将与先前WORKDIR指令的路径相对<span class="sb">`</span><span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="937-env-命令">9.3.7 ENV 命令<a class="anchor ms-1" href="#937-env-命令"><i class="fas fa-link"></i></a></h4>
<ul>
<li>
<p>用来为构建镜像设置环境变量。这个值将出现在构建阶段中所有后续指令的环境中。</p>
</li>
<li>
<p>语法：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">ENV</span> &lt;key&gt; &lt;value&gt;<span class="err">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="err"></span><span class="k">ENV</span> &lt;key&gt;<span class="o">=</span>&lt;value&gt; ...<span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="938-add-命令">9.3.8 ADD 命令<a class="anchor ms-1" href="#938-add-命令"><i class="fas fa-link"></i></a></h4>
<ul>
<li>
<p>用来从context上下文复制新文件、目录或远程文件url，并将它们添加到位于指定路径的映像文件系统中。</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">ADD</span> hom* /mydir/       通配符添加多个文件<span class="err">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="err"></span><span class="k">ADD</span> hom?.txt /mydir/   通配符添加<span class="err">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="err"></span><span class="k">ADD</span> test.txt relativeDir/  可以指定相对路径<span class="err">
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="err"></span><span class="k">ADD</span> test.txt /absoluteDir/ 也可以指定绝对路径<span class="err">
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="err"></span><span class="k">ADD</span> url <span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="939-copy-命令">9.3.9 COPY 命令<a class="anchor ms-1" href="#939-copy-命令"><i class="fas fa-link"></i></a></h4>
<ul>
<li>
<p>用来将context目录中指定文件复制到镜像的指定目录中</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">COPY</span> src dest<span class="err">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="err"></span><span class="k">COPY</span> <span class="o">[</span><span class="s2">&#34;&lt;src&gt;&#34;</span>,... <span class="s2">&#34;&lt;dest&gt;&#34;</span><span class="o">]</span><span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="9310-volume-命令">9.3.10 VOLUME 命令<a class="anchor ms-1" href="#9310-volume-命令"><i class="fas fa-link"></i></a></h4>
<ul>
<li>
<p>用来定义容器运行时可以挂在到宿主机的目录</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">VOLUME</span> <span class="p">[</span><span class="s2">&#34;/data&#34;</span><span class="p">]</span><span class="err">
</span></span></span></code></pre></div></li>
</ul>
<h4 id="9311-entrypoint命令">9.3.11 ENTRYPOINT命令<a class="anchor ms-1" href="#9311-entrypoint命令"><i class="fas fa-link"></i></a></h4>
<ul>
<li>
<p>用来指定容器启动时执行命令和CMD类似</p>
</li>
<li>
<p>语法:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="ln">1</span><span class="cl">  <span class="o">[</span><span class="s2">&#34;executable&#34;</span>, <span class="s2">&#34;param1&#34;</span>, <span class="s2">&#34;param2&#34;</span><span class="o">]</span><span class="err">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="err"></span><span class="k">ENTRYPOINT</span> <span class="nb">command</span> param1 param2<span class="err">
</span></span></span></code></pre></div><p>ENTRYPOINT指令，往往用于设置容器启动后的<strong>第一个命令</strong>，这对一个容器来说往往是固定的。
CMD指令，往往用于设置容器启动的第一个命令的<strong>默认参数</strong>，这对一个容器来说可以是变化的。</p>
</li>
</ul>
<h4 id="9311-entrypoint命令-1">9.3.11 ENTRYPOINT命令<a class="anchor ms-1" href="#9311-entrypoint命令-1"><i class="fas fa-link"></i></a></h4>
<h3 id="94-dockerfile构建springboot项目部署">9.4 Dockerfile构建springboot项目部署<a class="anchor ms-1" href="#94-dockerfile构建springboot项目部署"><i class="fas fa-link"></i></a></h3>
<h5 id="1准备springboot可运行项目">1.准备springboot可运行项目<a class="anchor ms-1" href="#1准备springboot可运行项目"><i class="fas fa-link"></i></a></h5>
<p><picture><img class="img-fluid" alt="image-20200605172151266" src="/posts/ddeb9b11/index/image-20200605172151266.png" loading="lazy"
    
     />
</picture>

</p>
<h5 id="2将可运行项目放入linux虚拟机中">2.将可运行项目放入linux虚拟机中<a class="anchor ms-1" href="#2将可运行项目放入linux虚拟机中"><i class="fas fa-link"></i></a></h5>
<p><picture><img class="img-fluid" alt="image-20200605172340380" src="/posts/ddeb9b11/index/image-20200605172340380.png" loading="lazy"
    
     />
</picture>

</p>
<h5 id="3编写dockerfile">3.编写Dockerfile<a class="anchor ms-1" href="#3编写dockerfile"><i class="fas fa-link"></i></a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">FROM</span><span class="s"> openjdk:8</span><span class="err">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /ems</span><span class="err">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="err"></span><span class="k">ADD</span> ems.jar /ems<span class="err">
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="err"></span><span class="k">EXPOSE</span><span class="s"> 8989</span><span class="err">
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="err"></span><span class="k">ENTRYPOINT</span> <span class="p">[</span><span class="s2">&#34;java&#34;</span><span class="p">,</span><span class="s2">&#34;-jar&#34;</span><span class="p">]</span><span class="err">
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="err"></span><span class="k">CMD</span> <span class="p">[</span><span class="s2">&#34;ems.jar&#34;</span><span class="p">]</span><span class="err">
</span></span></span></code></pre></div><h5 id="4构建镜像">4.构建镜像<a class="anchor ms-1" href="#4构建镜像"><i class="fas fa-link"></i></a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">[</span>root@localhost ems<span class="o">]</span><span class="c1"># docker build -t ems .</span>
</span></span></code></pre></div><h5 id="5运行镜像">5.运行镜像<a class="anchor ms-1" href="#5运行镜像"><i class="fas fa-link"></i></a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">[</span>root@localhost ems<span class="o">]</span><span class="c1"># docker run -p 8989:8989 ems</span>
</span></span></code></pre></div><h5 id="6访问项目">6.访问项目<a class="anchor ms-1" href="#6访问项目"><i class="fas fa-link"></i></a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="ln">1</span><span class="cl"><span class="err">http://10.15.0.8:8989/ems/login.html
</span></span></span></code></pre></div><p><picture><img class="img-fluid" alt="image-20200605173141636" src="/posts/ddeb9b11/index/image-20200605173141636.png" loading="lazy"
    
     />
</picture>

</p>
<hr>
<h2 id="10高级网络配置">10.高级网络配置<a class="anchor ms-1" href="#10高级网络配置"><i class="fas fa-link"></i></a></h2>
<h3 id="101-说明">10.1 说明<a class="anchor ms-1" href="#101-说明"><i class="fas fa-link"></i></a></h3>
<p>当 Docker 启动时，会自动在主机上创建一个 <code>docker0</code> 虚拟网桥，实际上是 Linux 的一个 bridge，可以理解为一个软件交换机。它会在挂载到它的网口之间进行转发。</p>
<p>同时，Docker 随机分配一个本地未占用的私有网段（在 <a href="https://tools.ietf.org/html/rfc1918" target="_blank" rel="noopener noreferrer">RFC1918</a> 中定义）中的一个地址给 <code>docker0</code> 接口。比如典型的 <code>172.17.42.1</code>，掩码为 <code>255.255.0.0</code>。此后启动的容器内的网口也会自动分配一个同一网段（<code>172.17.0.0/16</code>）的地址。</p>
<p>当创建一个 Docker 容器的时候，同时会创建了一对 <code>veth pair</code> 接口（当数据包发送到一个接口时，另外一个接口也可以收到相同的数据包）。这对接口一端在容器内，即 <code>eth0</code>；另一端在本地并被挂载到 <code>docker0</code> 网桥，名称以 <code>veth</code> 开头（例如 <code>vethAQI2QT</code>）。通过这种方式，主机可以跟容器通信，容器之间也可以相互通信。Docker 就创建了在主机和所有容器之间一个虚拟共享网络。</p>
<p><picture><img class="img-fluid" alt="image-20201125105847896" src="/posts/ddeb9b11/index/image-20201125105847896.png" loading="lazy"
    
     />
</picture>

</p>
<h3 id="102-查看网络信息">10.2 查看网络信息<a class="anchor ms-1" href="#102-查看网络信息"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl"><span class="gh"># docker network ls
</span></span></span></code></pre></div><h3 id="103-创建一个网桥">10.3 创建一个网桥<a class="anchor ms-1" href="#103-创建一个网桥"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl"><span class="gh"># docker network create -d bridge 网桥名称
</span></span></span></code></pre></div><h3 id="104-删除一个网桥">10.4 删除一个网桥<a class="anchor ms-1" href="#104-删除一个网桥"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl"><span class="gh"># docker network rm 网桥名称
</span></span></span></code></pre></div><h3 id="105-容器之前使用网络通信">10.5 容器之前使用网络通信<a class="anchor ms-1" href="#105-容器之前使用网络通信"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl"><span class="gh"># 1.查询当前网络配置
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="gh"></span><span class="k">-</span> docker network ls
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl">NETWORK ID          NAME                DRIVER              SCOPE
</span></span><span class="line"><span class="ln">2</span><span class="cl">8e424e5936b7        bridge              bridge              <span class="nb">local</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">17d974db02da        docker_gwbridge     bridge              <span class="nb">local</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">d6c326e433f7        host                host                <span class="nb">local</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl"><span class="gh"># 2.创建桥接网络
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="gh"></span><span class="k">-</span> docker network create -d bridge info
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker network create -d bridge info</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">6e4aaebff79b1df43a064e0e8fdab08f52d64ce34db78dd5184ce7aaaf550a2f
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker network ls</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">NETWORK ID          NAME                DRIVER              SCOPE
</span></span><span class="line"><span class="ln">5</span><span class="cl">8e424e5936b7        bridge              bridge              <span class="nb">local</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">17d974db02da        docker_gwbridge     bridge              <span class="nb">local</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">d6c326e433f7        host                host                <span class="nb">local</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">6e4aaebff79b        info                bridge              <span class="nb">local</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl"><span class="gh"># 3.启动容器指定使用网桥
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="gh"></span><span class="k">-</span> docker run -d -p 8890:80 --name nginx001 --network info nginx 
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="k">-</span> docker run -d -p 8891:80 --name nginx002 --network info nginx 
</span></span><span class="line"><span class="ln">4</span><span class="cl">	<span class="sb">`注意:一旦指定网桥后--name指定名字就是主机名,多个容器指定在同一个网桥时,可以在任意一个容器中使用主机名与容器进行互通`</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker run -d -p 8890:80 --name nginx001 --network info nginx </span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">c315bcc94e9ddaa36eb6c6f16ca51592b1ac8bf1ecfe9d8f01d892f3f10825fe
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker run -d -p 8891:80 --name nginx002 --network info nginx</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">f8682db35dd7fb4395f90edb38df7cad71bbfaba71b6a4c6e2a3a525cb73c2a5
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker ps</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                  NAMES
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">f8682db35dd7        nginx               <span class="s2">&#34;/docker-entrypoint.…&#34;</span>   <span class="m">3</span> seconds ago       Up <span class="m">2</span> seconds        0.0.0.0:8891-&gt;80/tcp   nginx002
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">c315bcc94e9d        nginx               <span class="s2">&#34;/docker-entrypoint.…&#34;</span>   <span class="m">7</span> minutes ago       Up <span class="m">7</span> minutes        0.0.0.0:8890-&gt;80/tcp   nginx001
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">b63169d43792        mysql:5.7.19        <span class="s2">&#34;docker-entrypoint.s…&#34;</span>   <span class="m">7</span> minutes ago       Up <span class="m">7</span> minutes        3306/tcp               mysql_mysql.1.s75qe5kkpwwttyf0wrjvd2cda
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker exec -it f8682db35dd7 /bin/bash</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">root@f8682db35dd7:/# curl http://nginx001
</span></span><span class="line"><span class="ln">12</span><span class="cl">&lt;!DOCTYPE html&gt;
</span></span><span class="line"><span class="ln">13</span><span class="cl">&lt;html&gt;
</span></span><span class="line"><span class="ln">14</span><span class="cl">&lt;head&gt;
</span></span><span class="line"><span class="ln">15</span><span class="cl">&lt;title&gt;Welcome to nginx!&lt;/title&gt;
</span></span><span class="line"><span class="ln">16</span><span class="cl">.....
</span></span></code></pre></div><hr>
<h2 id="11高级数据卷配置">11.高级数据卷配置<a class="anchor ms-1" href="#11高级数据卷配置"><i class="fas fa-link"></i></a></h2>
<h3 id="111-说明">11.1 说明<a class="anchor ms-1" href="#111-说明"><i class="fas fa-link"></i></a></h3>
<p><code>数据卷</code> 是一个可供一个或多个容器使用的特殊目录，它绕过 UFS，可以提供很多有用的特性：</p>
<ul>
<li><code>数据卷</code> 可以在容器之间共享和重用</li>
<li>对 <code>数据卷</code> 的修改会立马生效</li>
<li>对 <code>数据卷</code> 的更新，不会影响镜像</li>
<li><code>数据卷</code> 默认会一直存在，即使容器被删除</li>
</ul>
<blockquote>
<p>注意：<code>数据卷</code> 的使用，类似于 Linux 下对目录或文件进行 mount，镜像中的被指定为挂载点的目录中的文件会复制到数据卷中（仅数据卷为空时会复制）。</p>
</blockquote>
<h3 id="112-创建数据卷">11.2 创建数据卷<a class="anchor ms-1" href="#112-创建数据卷"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker volume create my-vol</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">my-vol
</span></span></code></pre></div><h3 id="113-查看数据卷">11.3 查看数据卷<a class="anchor ms-1" href="#113-查看数据卷"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker volume inspect my-vol       </span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="o">[</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">        <span class="s2">&#34;CreatedAt&#34;</span>: <span class="s2">&#34;2020-11-25T11:43:56+08:00&#34;</span>,
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">        <span class="s2">&#34;Driver&#34;</span>: <span class="s2">&#34;local&#34;</span>,
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">        <span class="s2">&#34;Labels&#34;</span>: <span class="o">{}</span>,
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">        <span class="s2">&#34;Mountpoint&#34;</span>: <span class="s2">&#34;/var/lib/docker/volumes/my-vol/_data&#34;</span>,
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;my-vol&#34;</span>,
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="s2">&#34;Options&#34;</span>: <span class="o">{}</span>,
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="s2">&#34;Scope&#34;</span>: <span class="s2">&#34;local&#34;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="o">]</span>
</span></span></code></pre></div><h3 id="114-挂载数据卷">11.4 挂载数据卷<a class="anchor ms-1" href="#114-挂载数据卷"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker run -d -P --name web  -v my-vol:/usr/share/nginx/html  nginx</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker inspect web</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">				<span class="s2">&#34;Mounts&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">                <span class="s2">&#34;Type&#34;</span>: <span class="s2">&#34;volume&#34;</span>,
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">                <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;my-vol&#34;</span>,
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">                <span class="s2">&#34;Source&#34;</span>: <span class="s2">&#34;/var/lib/docker/volumes/my-vol/_data&#34;</span>,
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">                <span class="s2">&#34;Destination&#34;</span>: <span class="s2">&#34;/usr/share/nginx/html&#34;</span>,
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">                <span class="s2">&#34;Driver&#34;</span>: <span class="s2">&#34;local&#34;</span>,
</span></span><span class="line"><span class="ln">10</span><span class="cl">                <span class="s2">&#34;Mode&#34;</span>: <span class="s2">&#34;z&#34;</span>,
</span></span><span class="line"><span class="ln">11</span><span class="cl">                <span class="s2">&#34;RW&#34;</span>: true,
</span></span><span class="line"><span class="ln">12</span><span class="cl">                <span class="s2">&#34;Propagation&#34;</span>: <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="o">]</span>,
</span></span></code></pre></div><h3 id="115-删除数据卷">11.5 删除数据卷<a class="anchor ms-1" href="#115-删除数据卷"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl">docker volume rm my-vol
</span></span></code></pre></div><hr>
<h2 id="12docker-compose">12.Docker Compose<a class="anchor ms-1" href="#12docker-compose"><i class="fas fa-link"></i></a></h2>
<h3 id="121-简介">12.1 简介<a class="anchor ms-1" href="#121-简介"><i class="fas fa-link"></i></a></h3>
<p><code>Compose</code> 项目是 Docker 官方的开源项目，负责实现对 Docker 容器集群的快速编排。从功能上看，跟 <code>OpenStack</code> 中的 <code>Heat</code> 十分类似。</p>
<p>其代码目前在 <a href="https://github.com/docker/compose" target="_blank" rel="noopener noreferrer">https://github.com/docker/compose</a> 上开源。</p>
<p><code>Compose</code> 定位是 「定义和运行多个 Docker 容器的应用（Defining and running multi-container Docker applications）」，其前身是开源项目 Fig。</p>
<p>通过第一部分中的介绍，我们知道使用一个 <code>Dockerfile</code> 模板文件，可以让用户很方便的定义一个单独的应用容器。然而，在日常工作中，经常会碰到需要多个容器相互配合来完成某项任务的情况。例如要实现一个 Web 项目，除了 Web 服务容器本身，往往还需要再加上后端的数据库服务容器，甚至还包括负载均衡容器等。</p>
<p><code>Compose</code> 恰好满足了这样的需求。它允许用户通过一个单独的 <code>docker-compose.yml</code> 模板文件（YAML 格式）来定义一组相关联的应用容器为一个项目（project）。</p>
<p><code>Compose</code> 中有两个重要的概念：</p>
<ul>
<li>服务 (<code>service</code>)：一个应用的容器，实际上可以包括若干运行相同镜像的容器实例。</li>
<li>项目 (<code>project</code>)：由一组关联的应用容器组成的一个完整业务单元，在 <code>docker-compose.yml</code> 文件中定义。</li>
</ul>
<p><code>Compose</code> 的默认管理对象是项目，通过子命令对项目中的一组容器进行便捷地生命周期管理。</p>
<p><code>Compose</code> 项目由 Python 编写，实现上调用了 Docker 服务提供的 API 来对容器进行管理。因此，只要所操作的平台支持 Docker API，就可以在其上利用 <code>Compose</code> 来进行编排管理。</p>
<h3 id="122-安装与卸载">12.2 安装与卸载<a class="anchor ms-1" href="#122-安装与卸载"><i class="fas fa-link"></i></a></h3>
<h6 id="1linux">1.linux<a class="anchor ms-1" href="#1linux"><i class="fas fa-link"></i></a></h6>
<ul>
<li>在 Linux 上的也安装十分简单，从 官方 GitHub Release 处直接下载编译好的二进制文件即可。例如，在 Linux 64 位系统上直接下载对应的二进制包。</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">$ sudo curl -L https://github.com/docker/compose/releases/download/1.25.5/docker-compose-<span class="sb">`</span>uname -s<span class="sb">`</span>-<span class="sb">`</span>uname -m<span class="sb">`</span> &gt; /usr/local/bin/docker-compose
</span></span><span class="line"><span class="ln">2</span><span class="cl">$ sudo chmod +x /usr/local/bin/docker-compose
</span></span></code></pre></div><h6 id="2macoswindow">2.macos、window<a class="anchor ms-1" href="#2macoswindow"><i class="fas fa-link"></i></a></h6>
<ul>
<li>Compose 可以通过 Python 的包管理工具 pip 进行安装，也可以直接下载编译好的二进制文件使用，甚至能够直接在 Docker 容器中运行。<code>Docker Desktop for Mac/Windows 自带 docker-compose 二进制文件，安装 Docker 之后可以直接使用</code>。</li>
</ul>
<h6 id="3bash命令补全">3.bash命令补全<a class="anchor ms-1" href="#3bash命令补全"><i class="fas fa-link"></i></a></h6>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl">$ curl -L https://raw.githubusercontent.com/docker/compose/1.25.5/contrib/completion/bash/docker-compose &gt; /etc/bash_completion.d/docker-compose
</span></span></code></pre></div><h6 id="4卸载">4.卸载<a class="anchor ms-1" href="#4卸载"><i class="fas fa-link"></i></a></h6>
<ul>
<li>如果是二进制包方式安装的，删除二进制文件即可。</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl">$ sudo rm /usr/local/bin/docker-compose
</span></span></code></pre></div><h6 id="5测试安装成功">5.测试安装成功<a class="anchor ms-1" href="#5测试安装成功"><i class="fas fa-link"></i></a></h6>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl">$ docker-compose --version
</span></span><span class="line"><span class="ln">2</span><span class="cl"> docker-compose version 1.25.5, build 4667896b
</span></span></code></pre></div><h3 id="123-docker-compose使用">12.3 docker compose使用<a class="anchor ms-1" href="#123-docker-compose使用"><i class="fas fa-link"></i></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl"><span class="gh"># 1.相关概念
</span></span></span></code></pre></div><p>首先介绍几个术语。</p>
<ul>
<li>服务 (<code>service</code>)：一个应用容器，实际上可以运行多个相同镜像的实例。</li>
<li>项目 (<code>project</code>)：由一组关联的应用容器组成的一个完整业务单元。∂一个项目可以由多个服务（容器）关联而成，<code>Compose</code> 面向项目进行管理。</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl"><span class="gh"># 2.场景
</span></span></span></code></pre></div><p>最常见的项目是 web 网站，该项目应该包含 web 应用和缓存。</p>
<ul>
<li>springboot应用</li>
<li>mysql服务</li>
<li>redis服务</li>
<li>elasticsearch服务</li>
<li>&hellip;&hellip;.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl"><span class="gh"># 3.docker-compose模板
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="gh"></span><span class="k">-</span> 参考文档:https://docker_practice.gitee.io/zh-cn/compose/compose_file.html
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3.0&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w">  </span><span class="nt">mysqldb</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">mysql:5.7.19</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">mysql</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">      </span>- <span class="s2">&#34;3306:3306&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w">      </span>- <span class="l">/root/mysql/conf:/etc/mysql/conf.d</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">      </span>- <span class="l">/root/mysql/logs:/logs</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">      </span>- <span class="l">/root/mysql/data:/var/lib/mysql</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w">      </span><span class="nt">MYSQL_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="l">root</span><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w">      </span>- <span class="l">ems</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w">      </span>- <span class="l">redis</span><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="w">  </span><span class="nt">redis</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">redis:4.0.14</span><span class="w">
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">redis</span><span class="w">
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="w">      </span>- <span class="s2">&#34;6379:6379&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="w">      </span>- <span class="l">ems</span><span class="w">
</span></span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="w">      </span>- <span class="l">/root/redis/data:/data</span><span class="w">
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l">redis-server</span><span class="w">
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="w"></span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="w">  </span><span class="nt">ems</span><span class="p">:</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="ln">1</span><span class="cl"><span class="gh"># 4.通过docker-compose运行一组容器
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="gh"></span><span class="k">-</span> 参考文档:https://docker_practice.gitee.io/zh-cn/compose/commands.html
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker-compose up    							//前台启动一组服务</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># docker-compose up -d 							//后台启动一组服务</span>
</span></span></code></pre></div><hr>
<h3 id="124-docker-compose-模板文件">12.4 docker-compose 模板文件<a class="anchor ms-1" href="#124-docker-compose-模板文件"><i class="fas fa-link"></i></a></h3>
<p>模板文件是使用 <code>Compose</code> 的核心，涉及到的指令关键字也比较多。但大家不用担心，这里面大部分指令跟 <code>docker run</code> 相关参数的含义都是类似的。</p>
<p>默认的模板文件名称为 <code>docker-compose.yml</code>，格式为 YAML 格式。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="w">  </span><span class="nt">webapp</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">examples/web</span><span class="w">
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="w">      </span>- <span class="s2">&#34;80:80&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="w">      </span>- <span class="s2">&#34;/data&#34;</span><span class="w">
</span></span></span></code></pre></div><p>注意每个服务都必须通过 <code>image</code> 指令指定镜像或 <code>build</code> 指令（需要 Dockerfile）等来自动构建生成镜像。</p>
<p>如果使用 <code>build</code> 指令，在 <code>Dockerfile</code> 中设置的选项(例如：<code>CMD</code>, <code>EXPOSE</code>, <code>VOLUME</code>, <code>ENV</code> 等) 将会自动被获取，无需在 <code>docker-compose.yml</code> 中重复设置。</p>
<p>下面分别介绍各个指令的用法。</p>
<h4 id="build">build<a class="anchor ms-1" href="#build"><i class="fas fa-link"></i></a></h4>
<p>指定 <code>Dockerfile</code> 所在文件夹的路径（可以是绝对路径，或者相对 docker-compose.yml 文件的路径）。 <code>Compose</code> 将会利用它自动构建这个镜像，然后使用这个镜像。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="w">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="w">  </span><span class="nt">webapp</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l">./dir</span><span class="w">
</span></span></span></code></pre></div><p>你也可以使用 <code>context</code> 指令指定 <code>Dockerfile</code> 所在文件夹的路径。</p>
<p>使用 <code>dockerfile</code> 指令指定 <code>Dockerfile</code> 文件名。</p>
<p>使用 <code>arg</code> 指令指定构建镜像时的变量。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="w">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="w">  </span><span class="nt">webapp</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l">./dir</span><span class="w">
</span></span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="w">      </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l">Dockerfile-alternate</span><span class="w">
</span></span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="w">      </span><span class="nt">args</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="w">        </span><span class="nt">buildno</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span></code></pre></div><h4 id="command">command<a class="anchor ms-1" href="#command"><i class="fas fa-link"></i></a></h4>
<p>覆盖容器启动后默认执行的命令。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l">echo &#34;hello world&#34;</span><span class="w">
</span></span></span></code></pre></div><h4 id="container_name">container_name<a class="anchor ms-1" href="#container_name"><i class="fas fa-link"></i></a></h4>
<p>指定容器名称。默认将会使用 <code>项目名称_服务名称_序号</code> 这样的格式。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">docker-web-container</span><span class="w">
</span></span></span></code></pre></div><blockquote>
<p>注意: 指定容器名称后，该服务将无法进行扩展（scale），因为 Docker 不允许多个容器具有相同的名称。</p>
</blockquote>
<h4 id="depends_on">depends_on<a class="anchor ms-1" href="#depends_on"><i class="fas fa-link"></i></a></h4>
<p>解决容器的依赖、启动先后的问题。以下例子中会先启动 <code>redis</code> <code>db</code> 再启动 <code>web</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w">  </span><span class="nt">web</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l">.</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">      </span>- <span class="l">db</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w">      </span>- <span class="l">redis</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">  </span><span class="nt">redis</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">redis</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w">  </span><span class="nt">db</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">postgres</span><span class="w">
</span></span></span></code></pre></div><blockquote>
<p>注意：<code>web</code> 服务不会等待 <code>redis</code> <code>db</code> 「完全启动」之后才启动。</p>
</blockquote>
<h4 id="env_file">env_file<a class="anchor ms-1" href="#env_file"><i class="fas fa-link"></i></a></h4>
<p>从文件中获取环境变量，可以为单独的文件路径或列表。</p>
<p>如果通过 <code>docker-compose -f FILE</code> 方式来指定 Compose 模板文件，则 <code>env_file</code> 中变量的路径会基于模板文件路径。</p>
<p>如果有变量名称与 <code>environment</code> 指令冲突，则按照惯例，以后者为准。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">env_file: .env
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">env_file:
</span></span><span class="line"><span class="ln">4</span><span class="cl">  - ./common.env
</span></span><span class="line"><span class="ln">5</span><span class="cl">  - ./apps/web.env
</span></span><span class="line"><span class="ln">6</span><span class="cl">  - /opt/secrets.env
</span></span></code></pre></div><p>环境变量文件中每一行必须符合格式，支持 <code>#</code> 开头的注释行。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1"># common.env: Set development environment</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="nv">PROG_ENV</span><span class="o">=</span>development
</span></span></code></pre></div><h4 id="environment">environment<a class="anchor ms-1" href="#environment"><i class="fas fa-link"></i></a></h4>
<p>设置环境变量。你可以使用数组或字典两种格式。</p>
<p>只给定名称的变量会自动获取运行 Compose 主机上对应变量的值，可以用来防止泄露不必要的数据。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="w">  </span><span class="nt">RACK_ENV</span><span class="p">:</span><span class="w"> </span><span class="l">development</span><span class="w">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="w">  </span><span class="nt">SESSION_SECRET</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="w"></span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="w">  </span>- <span class="l">RACK_ENV=development</span><span class="w">
</span></span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="w">  </span>- <span class="l">SESSION_SECRET</span><span class="w">
</span></span></span></code></pre></div><p>如果变量名称或者值中用到 <code>true|false，yes|no</code> 等表达 <a href="https://yaml.org/type/bool.html" target="_blank" rel="noopener noreferrer">布尔</a> 含义的词汇，最好放到引号里，避免 YAML 自动解析某些内容为对应的布尔语义。这些特定词汇，包括</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">y<span class="p">|</span>Y<span class="p">|</span>yes<span class="p">|</span>Yes<span class="p">|</span>YES<span class="p">|</span>n<span class="p">|</span>N<span class="p">|</span>no<span class="p">|</span>No<span class="p">|</span>NO<span class="p">|</span>true<span class="p">|</span>True<span class="p">|</span>TRUE<span class="p">|</span>false<span class="p">|</span>False<span class="p">|</span>FALSE<span class="p">|</span>on<span class="p">|</span>On<span class="p">|</span>ON<span class="p">|</span>off<span class="p">|</span>Off<span class="p">|</span>OFF
</span></span></code></pre></div><h4 id="healthcheck">healthcheck<a class="anchor ms-1" href="#healthcheck"><i class="fas fa-link"></i></a></h4>
<p>通过命令检查容器是否健康运行。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nt">healthcheck</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="w">  </span><span class="nt">test</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;CMD&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;curl&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;-f&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;http://localhost&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="w">  </span><span class="nt">interval</span><span class="p">:</span><span class="w"> </span><span class="l">1m30s</span><span class="w">
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="w">  </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l">10s</span><span class="w">
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="w">  </span><span class="nt">retries</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span></span></span></code></pre></div><h4 id="image">image<a class="anchor ms-1" href="#image"><i class="fas fa-link"></i></a></h4>
<p>指定为镜像名称或镜像 ID。如果镜像在本地不存在，<code>Compose</code> 将会尝试拉取这个镜像。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu</span><span class="w">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="w"></span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">orchardup/postgresql</span><span class="w">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="w"></span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">a4bc65fd</span><span class="w">
</span></span></span></code></pre></div><h4 id="networks">networks<a class="anchor ms-1" href="#networks"><i class="fas fa-link"></i></a></h4>
<p>配置容器连接的网络。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w">  </span><span class="nt">some-service</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">     </span>- <span class="l">some-network</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">     </span>- <span class="l">other-network</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w"></span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">  </span><span class="nt">some-network</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">  </span><span class="nt">other-network</span><span class="p">:</span><span class="w">
</span></span></span></code></pre></div><h4 id="ports">ports<a class="anchor ms-1" href="#ports"><i class="fas fa-link"></i></a></h4>
<p>暴露端口信息。</p>
<p>使用宿主端口：容器端口 <code>(HOST:CONTAINER)</code> 格式，或者仅仅指定容器的端口（宿主将会随机选择端口）都可以。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="w"> </span>- <span class="s2">&#34;3000&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="w"> </span>- <span class="s2">&#34;8000:8000&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="w"> </span>- <span class="s2">&#34;49100:22&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="w"> </span>- <span class="s2">&#34;127.0.0.1:8001:8001&#34;</span><span class="w">
</span></span></span></code></pre></div><p><em>注意：当使用 <code>HOST:CONTAINER</code> 格式来映射端口时，如果你使用的容器端口小于 60 并且没放到引号里，可能会得到错误结果，因为 <code>YAML</code> 会自动解析 <code>xx:yy</code> 这种数字格式为 60 进制。为避免出现这种问题，建议数字串都采用引号包括起来的字符串格式。</em></p>
<h4 id="sysctls">sysctls<a class="anchor ms-1" href="#sysctls"><i class="fas fa-link"></i></a></h4>
<p>配置容器内核参数。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nt">sysctls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="w">  </span><span class="nt">net.core.somaxconn</span><span class="p">:</span><span class="w"> </span><span class="m">1024</span><span class="w">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="w">  </span><span class="nt">net.ipv4.tcp_syncookies</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="w"></span><span class="nt">sysctls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="w">  </span>- <span class="l">net.core.somaxconn=1024</span><span class="w">
</span></span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="w">  </span>- <span class="l">net.ipv4.tcp_syncookies=0</span><span class="w">
</span></span></span></code></pre></div><h4 id="ulimits">ulimits<a class="anchor ms-1" href="#ulimits"><i class="fas fa-link"></i></a></h4>
<p>指定容器的 ulimits 限制值。</p>
<p>例如，指定最大进程数为 65535，指定文件句柄数为 20000（软限制，应用可以随时修改，不能超过硬限制） 和 40000（系统硬限制，只能 root 用户提高）。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="w">  </span><span class="nt">ulimits</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="w">    </span><span class="nt">nproc</span><span class="p">:</span><span class="w"> </span><span class="m">65535</span><span class="w">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="w">    </span><span class="nt">nofile</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="w">      </span><span class="nt">soft</span><span class="p">:</span><span class="w"> </span><span class="m">20000</span><span class="w">
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="w">      </span><span class="nt">hard</span><span class="p">:</span><span class="w"> </span><span class="m">40000</span><span class="w">
</span></span></span></code></pre></div><h4 id="volumes">volumes<a class="anchor ms-1" href="#volumes"><i class="fas fa-link"></i></a></h4>
<p>数据卷所挂载路径设置。可以设置为宿主机路径(<code>HOST:CONTAINER</code>)或者数据卷名称(<code>VOLUME:CONTAINER</code>)，并且可以设置访问模式 （<code>HOST:CONTAINER:ro</code>）。</p>
<p>该指令中路径支持相对路径。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="w"> </span>- <span class="l">/var/lib/mysql</span><span class="w">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="w"> </span>- <span class="l">cache/:/tmp/cache</span><span class="w">
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="w"> </span>- <span class="l">~/configs:/etc/configs/:ro</span><span class="w">
</span></span></span></code></pre></div><p>如果路径为数据卷名称，必须在文件中配置数据卷。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w">  </span><span class="nt">my_src</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">mysql:8.0</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">      </span>- <span class="l">mysql_data:/var/lib/mysql</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w"></span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">  </span><span class="nt">mysql_data</span><span class="p">:</span><span class="w">
</span></span></span></code></pre></div><hr>
<h3 id="125-docker-compose-常用命令">12.5 docker-compose 常用命令<a class="anchor ms-1" href="#125-docker-compose-常用命令"><i class="fas fa-link"></i></a></h3>
<h5 id="1-命令对象与格式">1. 命令对象与格式<a class="anchor ms-1" href="#1-命令对象与格式"><i class="fas fa-link"></i></a></h5>
<p>对于 Compose 来说，大部分命令的对象既可以是项目本身，也可以指定为项目中的服务或者容器。如果没有特别的说明，命令对象将是项目，这意味着项目中所有的服务都会受到命令影响。</p>
<p>执行 <code>docker-compose [COMMAND] --help</code> 或者 <code>docker-compose help [COMMAND]</code> 可以查看具体某个命令的使用格式。</p>
<p><code>docker-compose</code> 命令的基本的使用格式是</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">docker-compose <span class="o">[</span>-f<span class="o">=</span>&lt;arg&gt;...<span class="o">]</span> <span class="o">[</span>options<span class="o">]</span> <span class="o">[</span>COMMAND<span class="o">]</span> <span class="o">[</span>ARGS...<span class="o">]</span>
</span></span></code></pre></div><h5 id="2-命令选项">2. 命令选项<a class="anchor ms-1" href="#2-命令选项"><i class="fas fa-link"></i></a></h5>
<ul>
<li><code>-f, --file FILE</code> 指定使用的 Compose 模板文件，默认为 <code>docker-compose.yml</code>，可以多次指定。</li>
<li><code>-p, --project-name NAME</code> 指定项目名称，默认将使用所在目录名称作为项目名。</li>
<li><code>--x-networking</code> 使用 Docker 的可拔插网络后端特性</li>
<li><code>--x-network-driver DRIVER</code> 指定网络后端的驱动，默认为 <code>bridge</code></li>
<li><code>--verbose</code> 输出更多调试信息。</li>
<li><code>-v, --version</code> 打印版本并退出。</li>
</ul>
<h5 id="3命令使用说明">3.命令使用说明<a class="anchor ms-1" href="#3命令使用说明"><i class="fas fa-link"></i></a></h5>
<h5 id="up">up<a class="anchor ms-1" href="#up"><i class="fas fa-link"></i></a></h5>
<p>格式为 <code>docker-compose up [options] [SERVICE...]</code>。</p>
<ul>
<li>
<p>该命令十分强大，它将尝试自动完成包括构建镜像，（重新）创建服务，启动服务，并关联服务相关容器的一系列操作。</p>
</li>
<li>
<p>链接的服务都将会被自动启动，除非已经处于运行状态。</p>
</li>
<li>
<p>可以说，大部分时候都可以直接通过该命令来启动一个项目。</p>
</li>
<li>
<p>默认情况，<code>docker-compose up</code> 启动的容器都在前台，控制台将会同时打印所有容器的输出信息，可以很方便进行调试。</p>
</li>
<li>
<p>当通过 <code>Ctrl-C</code> 停止命令时，所有容器将会停止。</p>
</li>
<li>
<p>如果使用 <code>docker-compose up -d</code>，将会在后台启动并运行所有的容器。一般推荐生产环境下使用该选项。</p>
</li>
<li>
<p>默认情况，如果服务容器已经存在，<code>docker-compose up</code> 将会尝试停止容器，然后重新创建（保持使用 <code>volumes-from</code> 挂载的卷），以保证新启动的服务匹配 <code>docker-compose.yml</code> 文件的最新内容</p>
</li>
</ul>
<hr>
<h5 id="down">down<a class="anchor ms-1" href="#down"><i class="fas fa-link"></i></a></h5>
<ul>
<li>此命令将会停止 <code>up</code> 命令所启动的容器，并移除网络</li>
</ul>
<hr>
<h5 id="exec">exec<a class="anchor ms-1" href="#exec"><i class="fas fa-link"></i></a></h5>
<ul>
<li>进入指定的容器。</li>
</ul>
<hr>
<h5 id="ps">ps<a class="anchor ms-1" href="#ps"><i class="fas fa-link"></i></a></h5>
<p>格式为 <code>docker-compose ps [options] [SERVICE...]</code>。</p>
<p>列出项目中目前的所有容器。</p>
<p>选项：</p>
<ul>
<li><code>-q</code> 只打印容器的 ID 信息。</li>
</ul>
<hr>
<h5 id="restart">restart<a class="anchor ms-1" href="#restart"><i class="fas fa-link"></i></a></h5>
<p>格式为 <code>docker-compose restart [options] [SERVICE...]</code>。</p>
<p>重启项目中的服务。</p>
<p>选项：</p>
<ul>
<li><code>-t, --timeout TIMEOUT</code> 指定重启前停止容器的超时（默认为 10 秒）。</li>
</ul>
<hr>
<h5 id="rm">rm<a class="anchor ms-1" href="#rm"><i class="fas fa-link"></i></a></h5>
<p>格式为 <code>docker-compose rm [options] [SERVICE...]</code>。</p>
<p>删除所有（停止状态的）服务容器。推荐先执行 <code>docker-compose stop</code> 命令来停止容器。</p>
<p>选项：</p>
<ul>
<li><code>-f, --force</code> 强制直接删除，包括非停止状态的容器。一般尽量不要使用该选项。</li>
<li><code>-v</code> 删除容器所挂载的数据卷。</li>
</ul>
<hr>
<h5 id="start">start<a class="anchor ms-1" href="#start"><i class="fas fa-link"></i></a></h5>
<p>格式为 <code>docker-compose start [SERVICE...]</code>。</p>
<p>启动已经存在的服务容器。</p>
<hr>
<h5 id="stop">stop<a class="anchor ms-1" href="#stop"><i class="fas fa-link"></i></a></h5>
<p>格式为 <code>docker-compose stop [options] [SERVICE...]</code>。</p>
<p>停止已经处于运行状态的容器，但不删除它。通过 <code>docker-compose start</code> 可以再次启动这些容器。</p>
<p>选项：</p>
<ul>
<li><code>-t, --timeout TIMEOUT</code> 停止容器时候的超时（默认为 10 秒）。</li>
</ul>
<hr>
<h5 id="top">top<a class="anchor ms-1" href="#top"><i class="fas fa-link"></i></a></h5>
<p>查看各个服务容器内运行的进程。</p>
<hr>
<h5 id="unpause">unpause<a class="anchor ms-1" href="#unpause"><i class="fas fa-link"></i></a></h5>
<p>格式为 <code>docker-compose unpause [SERVICE...]</code>。</p>
<p>恢复处于暂停状态中的服务。</p>
<hr>
<h2 id="13docker可视化工具">13.docker可视化工具<a class="anchor ms-1" href="#13docker可视化工具"><i class="fas fa-link"></i></a></h2>
<h4 id="131-安装portainer">13.1 安装Portainer<a class="anchor ms-1" href="#131-安装portainer"><i class="fas fa-link"></i></a></h4>
<p>官方安装说明：<a href="http://www.yunweipai.com/go?_=8fe4813824aHR0cHM6Ly93d3cucG9ydGFpbmVyLmlvL2luc3RhbGxhdGlvbi8=" target="_blank" rel="noopener noreferrer">https://www.portainer.io/installation/</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">[</span>root@ubuntu1804 ~<span class="o">]</span><span class="c1">#docker pull  portainer/portainer</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="o">[</span>root@ubuntu1804 ~<span class="o">]</span><span class="c1">#docker volume create portainer_data</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">portainer_data
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="o">[</span>root@ubuntu1804 ~<span class="o">]</span><span class="c1">#docker run -d -p 8000:8000 -p 9000:9000 --name=portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">20db26b67b791648c2ef6aee444a5226a9c897ebcf0160050e722dbf4a4906e3
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="o">[</span>root@ubuntu1804 ~<span class="o">]</span><span class="c1">#docker ps </span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">CONTAINER ID        IMAGE                 COMMAND             CREATED             STATUS              PORTS                                            NAMES
</span></span><span class="line"><span class="ln">9</span><span class="cl">20db26b67b79        portainer/portainer   <span class="s2">&#34;/portainer&#34;</span>        <span class="m">5</span> seconds ago       Up <span class="m">4</span> seconds        0.0.0.0:8000-&gt;8000/tcp, 0.0.0.0:9000-&gt;9000/tcp   portainer
</span></span></code></pre></div><h4 id="132-登录和使用portainer">13.2 登录和使用Portainer<a class="anchor ms-1" href="#132-登录和使用portainer"><i class="fas fa-link"></i></a></h4>
<blockquote>
<p>用浏览器访问：<code>http://localhost:9000</code></p>
</blockquote>
<p><picture><img class="img-fluid" alt="image-20201223231707738" src="/posts/ddeb9b11/index/image-20201223231707738.png" loading="lazy"
    
     />
</picture>

</p></div></div>
  <div class="card-footer"><div class="post-navs d-flex justify-content-evenly"><div class="post-nav post-prev">
    <i class="fas fa-fw fa-chevron-circle-down post-prev-icon" data-fa-transform="rotate-90"></i>
    <a href="/posts/68d43a4d/">LeetCode-1576-替换所有的问号
</a>
  </div><div class="post-nav post-next">
    <a href="/posts/26f6376f/">Docker-配置文档-图片
</a>
    <i class="fas fa-fw fa-chevron-circle-down post-next-icon" data-fa-transform="rotate-270"></i>
  </div></div></div>
</article><div class="post-copyright mb-3 row card component" id="post-copyright">
    <div class="card-header">
        <h2 class="card-title">版权</h2>
    </div>
    <div class="card-body"><a class="d-flex align-items-center flex-column" target="_blank" rel="license noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh">
  <span><i class="fab fa-fw fa-2x fa-creative-commons"></i><i class="fab fa-fw fa-2x fa-creative-commons-by"></i><i class="fab fa-fw fa-2x fa-creative-commons-nc"></i><i class="fab fa-fw fa-2x fa-creative-commons-nd"></i></span>
  CC BY-NC-ND 4.0 
</a>


    </div>
</div><section class="related-posts row card component">
    <div class="card-header">
      <h2 class="card-title">相关文章</h2>
    </div>
    <div class="card-body">
      <ul class="post-list"><li>
          <a href="/posts/8b63f587/">Docker基础入门
</a>
          <span class="float-end post-date">2022-01-03
</span>
        </li><li>
          <a href="/posts/37cab689/">Hexo-NexT使用LaTeX公式
</a>
          <span class="float-end post-date">2021-08-03
</span>
        </li><li>
          <a href="/posts/19323af8/">首次部署网站-Hexo-Nginx
</a>
          <span class="float-end post-date">2021-07-31
</span>
        </li><li>
          <a href="/posts/68d43a4d/">LeetCode-1576-替换所有的问号
</a>
          <span class="float-end post-date">2022-01-05
</span>
        </li><li>
          <a href="/posts/e1f1048f/">LeetCode-913-猫和老鼠
</a>
          <span class="float-end post-date">2022-01-04
</span>
        </li></ul>
    </div>
  </section></div>
</div><aside class="col-lg-4 sidebar d-flex">
  <div class="container d-flex flex-column">
    
    <div class="card row text-center profile component">
  <div class="card-body">
    <div class="col-12 d-flex align-items-center justify-content-center"><picture><img class="profile-avatar rounded-circle" alt="jimyag" src="/images/spider-man.jpg" loading="lazy" data-viewer-invisible
     width="556" height="559"
     />
</picture>
</div>
    <div class="col-12 profile-meta"><div class="profile-name">jimyag</div><div class="profile-bio">Gopher</div><div class="profile-location"><i class="fas fa-fw fa-map-marker-alt"></i>Shanghai</div><div class="profile-about"><i class="fas fa-fw fa-user"></i><a href="/about/">About</a></div><nav class="social-links nav justify-content-center"><a class="nav-link social-link" href="mailto:i@jimyag.cn" title="Email">
      <i class="fas fa-fw fa-2x fa-envelope"></i>
    </a><a class="nav-link social-link" target="_blank" href="https://github.com/jimyag" title="GitHub" rel="noopener noreferrer">
        <i class="fa-fw fa-2x fab fa-github"></i>
      </a><a class="nav-link social-link" target="_blank" href="/index.xml" title="RSS" rel="noopener noreferrer">
    <i class="fas fa-fw fa-2x fa-rss"></i>
  </a></nav>
</div>
  </div>
</div>
<div class="post-toc row mb-4 card component" id="postTOC">
  <div class="card-header">
    <h2 class="card-title">目录</h2>
  </div>
  <div class="card-body">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#1什么是-docker">1.什么是 Docker</a>
      <ul>
        <li><a href="#11-官方定义">1.1 官方定义</a></li>
        <li><a href="#12-docker的起源">1.2 Docker的起源</a></li>
      </ul>
    </li>
    <li><a href="#2为什么是docker">2.为什么是Docker</a></li>
    <li><a href="#3docker和虚拟机区别">3.Docker和虚拟机区别</a></li>
    <li><a href="#4docker的安装">4.Docker的安装</a>
      <ul>
        <li><a href="#41-安装dockercentos7x">4.1 安装docker(centos7.x)</a></li>
        <li><a href="#42-bash安装通用所有平台">4.2 bash安装(通用所有平台)</a></li>
      </ul>
    </li>
    <li><a href="#5docker-的核心架构">5.Docker 的核心架构</a></li>
    <li><a href="#6-docker-配置阿里镜像加速服务">6. Docker 配置阿里镜像加速服务</a>
      <ul>
        <li><a href="#61-docker-运行流程">6.1 docker 运行流程</a></li>
        <li><a href="#62-docker配置阿里云镜像加速">6.2 docker配置阿里云镜像加速</a></li>
      </ul>
    </li>
    <li><a href="#7docker的入门应用">7.Docker的入门应用</a>
      <ul>
        <li><a href="#71-docker-的第一个程序">7.1 docker 的第一个程序</a></li>
      </ul>
    </li>
    <li><a href="#8常用命令">8.常用命令</a>
      <ul>
        <li><a href="#61-辅助命令">6.1 辅助命令</a></li>
        <li><a href="#62-images-镜像命令">6.2 Images 镜像命令</a></li>
        <li><a href="#63-contrainer-容器命令">6.3 Contrainer 容器命令</a></li>
      </ul>
    </li>
    <li><a href="#7docker的镜像原理">7.docker的镜像原理</a>
      <ul>
        <li><a href="#71-镜像是什么">7.1 镜像是什么？</a></li>
        <li><a href="#72-为什么一个镜像会那么大">7.2 为什么一个镜像会那么大？</a></li>
        <li><a href="#73-docker镜像原理">7.3 Docker镜像原理</a></li>
        <li><a href="#74-为什么docker镜像要采用这种分层结构呢">7.4 为什么docker镜像要采用这种分层结构呢?</a></li>
      </ul>
    </li>
    <li><a href="#8docker安装常用服务">8.Docker安装常用服务</a>
      <ul>
        <li><a href="#81-安装mysql">8.1 安装mysql</a></li>
        <li><a href="#82-安装redis服务">8.2 安装Redis服务</a></li>
        <li><a href="#83-安装nginx">8.3 安装Nginx</a></li>
        <li><a href="#84-安装tomcat">8.4 安装Tomcat</a></li>
        <li><a href="#85-安装mongodb数据库">8.5 安装MongoDB数据库</a></li>
        <li><a href="#86-安装elasticsearch">8.6 安装ElasticSearch</a></li>
      </ul>
    </li>
    <li><a href="#10docker中出现如下错误解决方案">10.Docker中出现如下错误解决方案</a></li>
    <li><a href="#9dockerfile">9.Dockerfile</a>
      <ul>
        <li><a href="#91-什么是dockerfile">9.1 什么是Dockerfile</a></li>
        <li><a href="#92-dockerfile解析过程">9.2 Dockerfile解析过程</a></li>
        <li><a href="#93-dockerfile的保留命令">9.3 Dockerfile的保留命令</a></li>
        <li><a href="#94-dockerfile构建springboot项目部署">9.4 Dockerfile构建springboot项目部署</a></li>
      </ul>
    </li>
    <li><a href="#10高级网络配置">10.高级网络配置</a>
      <ul>
        <li><a href="#101-说明">10.1 说明</a></li>
        <li><a href="#102-查看网络信息">10.2 查看网络信息</a></li>
        <li><a href="#103-创建一个网桥">10.3 创建一个网桥</a></li>
        <li><a href="#104-删除一个网桥">10.4 删除一个网桥</a></li>
        <li><a href="#105-容器之前使用网络通信">10.5 容器之前使用网络通信</a></li>
      </ul>
    </li>
    <li><a href="#11高级数据卷配置">11.高级数据卷配置</a>
      <ul>
        <li><a href="#111-说明">11.1 说明</a></li>
        <li><a href="#112-创建数据卷">11.2 创建数据卷</a></li>
        <li><a href="#113-查看数据卷">11.3 查看数据卷</a></li>
        <li><a href="#114-挂载数据卷">11.4 挂载数据卷</a></li>
        <li><a href="#115-删除数据卷">11.5 删除数据卷</a></li>
      </ul>
    </li>
    <li><a href="#12docker-compose">12.Docker Compose</a>
      <ul>
        <li><a href="#121-简介">12.1 简介</a></li>
        <li><a href="#122-安装与卸载">12.2 安装与卸载</a></li>
        <li><a href="#123-docker-compose使用">12.3 docker compose使用</a></li>
        <li><a href="#124-docker-compose-模板文件">12.4 docker-compose 模板文件</a></li>
        <li><a href="#125-docker-compose-常用命令">12.5 docker-compose 常用命令</a></li>
      </ul>
    </li>
    <li><a href="#13docker可视化工具">13.docker可视化工具</a>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div><section class="recent-posts row card component">
  <div class="card-header">
    <h2 class="card-title">最近文章</h2>
  </div>
  <div class="card-body">
    <ul class="post-list"><li>
        <a href="/posts/6db6b747/">Google MapReduce翻译
</a>
      </li><li>
        <a href="/posts/f6adfb46/">6.824 Spring 2020 Lab1 MapReduce文档翻译
</a>
      </li><li>
        <a href="/posts/14976c16/">我的notion规划
</a>
      </li><li>
        <a href="/posts/9c78a390/">Git开发分支落后远程主分支
</a>
      </li><li>
        <a href="/posts/0f0b28a1/">Oh My Zsh进入git目录卡顿
</a>
      </li></ul>
  </div>
</section><section class="series-taxonomies row card component">
      <div class="card-header">
        <h2 class="card-title">
          <a href="/series">专栏</a>
        </h2>
      </div>
      <div class="card-body">
        <div class="py-2"><a href="/series/leetcode/" class="badge rounded post-taxonomy" title="leetcode">
            leetcode<span class="badge badge-sm text-white bg-accent ms-1">32</span></a><a href="/series/%E4%BB%8E0%E5%88%B01%E5%AE%9E%E7%8E%B0%E5%AE%8C%E6%95%B4%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/" class="badge rounded post-taxonomy" title="从0到1实现完整的微服务框架">
            从0到1实现完整的微服务框架<span class="badge badge-sm text-white bg-accent ms-1">12</span></a><a href="/series/%E7%89%9B%E5%AE%A2top101/" class="badge rounded post-taxonomy" title="牛客TOP101">
            牛客TOP101<span class="badge badge-sm text-white bg-accent ms-1">3</span></a><a href="/series/mit6.824/" class="badge rounded post-taxonomy" title="MIT6.824">
            MIT6.824<span class="badge badge-sm text-white bg-accent ms-1">2</span></a><a href="/series/vim/" class="badge rounded post-taxonomy" title="vim">
            vim<span class="badge badge-sm text-white bg-accent ms-1">1</span></a></div>
      </div>
    </section><section class="categories-taxonomies row card component">
      <div class="card-header">
        <h2 class="card-title">
          <a href="/categories">分类</a>
        </h2>
      </div>
      <div class="card-body">
        <div class="py-2"><a href="/categories/leetcode/" class="badge rounded post-taxonomy" title="LeetCode">
            LeetCode<span class="badge badge-sm text-white bg-accent ms-1">32</span></a><a href="/categories/%E6%95%99%E7%A8%8B/" class="badge rounded post-taxonomy" title="教程">
            教程<span class="badge badge-sm text-white bg-accent ms-1">9</span></a><a href="/categories/go/" class="badge rounded post-taxonomy" title="Go">
            Go<span class="badge badge-sm text-white bg-accent ms-1">4</span></a><a href="/categories/%E7%AE%97%E6%B3%95/" class="badge rounded post-taxonomy" title="算法">
            算法<span class="badge badge-sm text-white bg-accent ms-1">4</span></a><a href="/categories/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" class="badge rounded post-taxonomy" title="编译原理">
            编译原理<span class="badge badge-sm text-white bg-accent ms-1">3</span></a><a href="/categories/%E8%B8%A9%E5%9D%91/" class="badge rounded post-taxonomy" title="踩坑">
            踩坑<span class="badge badge-sm text-white bg-accent ms-1">3</span></a><a href="/categories/hexo/" class="badge rounded post-taxonomy" title="Hexo">
            Hexo<span class="badge badge-sm text-white bg-accent ms-1">2</span></a><a href="/categories/web/" class="badge rounded post-taxonomy" title="Web">
            Web<span class="badge badge-sm text-white bg-accent ms-1">2</span></a><a href="/categories/yolov5/" class="badge rounded post-taxonomy" title="YOLOV5">
            YOLOV5<span class="badge badge-sm text-white bg-accent ms-1">2</span></a><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" class="badge rounded post-taxonomy" title="计算机网络">
            计算机网络<span class="badge badge-sm text-white bg-accent ms-1">2</span></a><a href="/categories" class="badge rounded post-taxonomy" title='全部'>
          全部
          <span class="badge badge-sm text-white bg-accent ms-1">22</span>
        </a></div>
      </div>
    </section><section class="tags-taxonomies row card component">
      <div class="card-header">
        <h2 class="card-title">
          <a href="/tags">标签</a>
        </h2>
      </div>
      <div class="card-body">
        <div class="py-2"><a href="/tags/%E6%95%99%E7%A8%8B/" class="badge rounded post-taxonomy" title="教程">
            教程<span class="badge badge-sm text-white bg-accent ms-1">29</span></a><a href="/tags/%E4%B8%AD%E7%AD%89/" class="badge rounded post-taxonomy" title="中等">
            中等<span class="badge badge-sm text-white bg-accent ms-1">14</span></a><a href="/tags/%E7%AE%80%E5%8D%95/" class="badge rounded post-taxonomy" title="简单">
            简单<span class="badge badge-sm text-white bg-accent ms-1">13</span></a><a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" class="badge rounded post-taxonomy" title="微服务">
            微服务<span class="badge badge-sm text-white bg-accent ms-1">12</span></a><a href="/tags/grpc/" class="badge rounded post-taxonomy" title="gRPC">
            gRPC<span class="badge badge-sm text-white bg-accent ms-1">10</span></a><a href="/tags/go/" class="badge rounded post-taxonomy" title="Go">
            Go<span class="badge badge-sm text-white bg-accent ms-1">9</span></a><a href="/tags/%E6%A8%A1%E6%8B%9F/" class="badge rounded post-taxonomy" title="模拟">
            模拟<span class="badge badge-sm text-white bg-accent ms-1">7</span></a><a href="/tags/%E5%A4%8D%E4%B9%A0%E8%B5%84%E6%96%99/" class="badge rounded post-taxonomy" title="复习资料">
            复习资料<span class="badge badge-sm text-white bg-accent ms-1">6</span></a><a href="/tags/%E5%9B%B0%E9%9A%BE/" class="badge rounded post-taxonomy" title="困难">
            困难<span class="badge badge-sm text-white bg-accent ms-1">5</span></a><a href="/tags/%E7%AE%97%E6%B3%95/" class="badge rounded post-taxonomy" title="算法">
            算法<span class="badge badge-sm text-white bg-accent ms-1">5</span></a><a href="/tags" class="badge rounded post-taxonomy" title='全部'>
          全部
          <span class="badge badge-sm text-white bg-accent ms-1">81</span>
        </a></div>
      </div>
    </section>
    
  </div>
</aside>
</div>
    </main><footer class="footer mt-auto py-3 text-center container"><nav class="social-links nav justify-content-center mb-2"><a class="nav-link social-link" href="mailto:i@jimyag.cn" title="Email">
      <i class="fas fa-fw fa-2x fa-envelope"></i>
    </a><a class="nav-link social-link" target="_blank" href="https://github.com/jimyag" title="GitHub" rel="noopener noreferrer">
        <i class="fa-fw fa-2x fab fa-github"></i>
      </a><a class="nav-link social-link" target="_blank" href="/index.xml" title="RSS" rel="noopener noreferrer">
    <i class="fas fa-fw fa-2x fa-rss"></i>
  </a></nav>
<div class="copyright mb-2">
  Copyright © 2019-2022 jimyag. All Rights Reserved. 
</div>
<div class="powered-by mb-2">
  <a href="https://beian.miit.gov.cn" target="_blank" rel="noopener noreferrer">陕ICP备2020018182号-1 </a>
</div></footer>
<script src="/assets/main/bundle.min.b5532796c3cf4f82f5b0254d4790694b9a7766fb69b6fc6bd76c68a1946df067.js" integrity="sha256-tVMnlsPPT4L1sCVNR5BpS5p3Zvtptvxr12xooZRt8Gc=" crossorigin="anonymous" defer></script><script src="/assets/icons/bundle.min.dfcbe757302616d36e2f117823c56facf382204bf3ab9ea29dffd5f2fc56bdef.js" integrity="sha256-38vnVzAmFtNuLxF4I8VvrPOCIEvzq56inf/V8vxWve8=" crossorigin="anonymous" defer></script>
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('\/service-worker.min.js').then(function(reg) {
      console.log('Successfully registered service worker', reg);
    }).catch(function(err) {
      console.warn('Error whilst registering service worker', err);
    });
  });
}
</script><script src="/assets/viewer/bundle.min.0ec873e11f754ed0ad81a68dca8496e24286666354e9c7c11ff339c390f086f0.js" integrity="sha256-Dshz4R91TtCtgaaNyoSW4kKGZmNU6cfBH/M5w5DwhvA=" crossorigin="anonymous" defer></script>
</body>
</html>
